/*! For license information please see chunk.580104515a043b931981.js.LICENSE.txt */
"use strict";(self.webpackChunkai_workout_assistant=self.webpackChunkai_workout_assistant||[]).push([[41],{73673:(n,t,e)=>{e.d(t,{R:()=>a,i:()=>o});var r=e(46574);function o(...n){(0,r._K)().getBool("IS_TEST")||(0,r._K)().getBool("PROD")||console.warn(...n)}function a(...n){(0,r._K)().getBool("IS_TEST")||(0,r._K)().getBool("PROD")||console.log(...n)}},4888:(n,t,e)=>{e.d(t,{t:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({abs_:function(n){const t=(0,a.YT)(n,"x","abs");if("complex64"===t.dtype){const n={x:t};return r.T2.runKernel(o.$zE,n)}{const n={x:t};return r.T2.runKernel(o.ljI,n)}}})},12804:(n,t,e)=>{e.d(t,{H:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({acos_:function(n){const t={x:(0,a.YT)(n,"x","acos")};return r.T2.runKernel(o.Vvy,t)}})},37558:(n,t,e)=>{e.d(t,{F:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({acosh_:function(n){const t={x:(0,a.YT)(n,"x","acosh")};return r.T2.runKernel(o.PH8,t)}})},37523:(n,t,e)=>{e.d(t,{W:()=>i});var r=e(67897),o=e(15441),a=e(30565),s=e(28189);const i=(0,e(70929).op)({add_:function(n,t){let e=(0,s.YT)(n,"a","add"),i=(0,s.YT)(t,"b","add");[e,i]=(0,a.h0)(e,i);const u={a:e,b:i};return r.T2.runKernel(o.OMN,u)}})},16054:(n,t,e)=>{e.d(t,{Q:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({addN_:function(n){s.vA(Array.isArray(n),(()=>"The argument passed to tf.addN() must be a list of tensors")),s.vA(n.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`));const t=n.map(((n,t)=>(0,a.YT)(n,`tensors${t}`,"addN"))),e=t[0];t.forEach((n=>{if(n.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((n=>{if(!s.r1(n.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const i=t;return r.T2.runKernel(o.EkD,i)}})},12307:(n,t,e)=>{e.d(t,{Q:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({all_:function(n,t=null,e=!1){const s={x:(0,a.YT)(n,"x","all","bool")},i={axis:t,keepDims:e};return r.T2.runKernel(o.u8Z,s,i)}})},89326:(n,t,e)=>{e.d(t,{b:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({any_:function(n,t=null,e=!1){const s={x:(0,a.YT)(n,"x","any","bool")},i={axis:t,keepDims:e};return r.T2.runKernel(o.FSt,s,i)}})},10897:(n,t,e)=>{e.d(t,{F:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({argMax_:function(n,t=0){const e={x:(0,a.YT)(n,"x","argMax")},s={axis:t};return r.T2.runKernel(o.Jp_,e,s)}})},54339:(n,t,e)=>{e.d(t,{X:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({argMin_:function(n,t=0){const e={x:(0,a.YT)(n,"x","argMin")},s={axis:t};return r.T2.runKernel(o.p_m,e,s)}})},81613:(n,t,e)=>{function r(n,t,e,r=!0){let o=[];if(r)o=o.concat(t.slice(0)),o.push(n[0]/e),o=o.concat(n.slice(1));else{o=o.concat(n[0]);const e=t.length;for(let r=0;r<e;++r)o=o.concat([n[r+1]/t[r],t[r]]);o=o.concat(n.slice(e+1))}return o}function o(n,t,e=!0){const r=[];if(e){r.push(t);for(let e=t+1;e<n;++e)e<=2*t?(r.push(e),r.push(e-(t+1))):r.push(e)}else{const e=[],o=[];for(let r=1;r<n;++r)r>=2*t+1||r%2==1?o.push(r):e.push(r);r.push(...e),r.push(0),r.push(...o)}return r}function a(n,t,e,r=!0){const o=[];r?o.push(n[0]/e):o.push(n[0]*e);for(let e=1;e<n.length;++e)e<=t.length?r?o.push(t[e-1]*n[e]):o.push(n[e]/t[e-1]):o.push(n[e]);return o}function s(n,t){const e=[0];for(let r=0;r<t;++r)e.push(n[r][0]);return e}function i(n,t,e){const r=n.slice(0,1);for(let o=0;o<e;++o)r.push(n[o+1]-t[o][0]-t[o][1]);return r}e.d(t,{AO:()=>i,VN:()=>a,Ym:()=>s,b$:()=>o,dE:()=>r})},66841:(n,t,e)=>{e.d(t,{q:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({asin_:function(n){const t={x:(0,a.YT)(n,"x","asin")};return r.T2.runKernel(o.QKF,t)}})},50269:(n,t,e)=>{e.d(t,{y:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({asinh_:function(n){const t={x:(0,a.YT)(n,"x","asinh")};return r.T2.runKernel(o.epO,t)}})},29580:(n,t,e)=>{e.d(t,{r:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({atan_:function(n){const t={x:(0,a.YT)(n,"x","atan")};return r.T2.runKernel(o.TyE,t)}})},21404:(n,t,e)=>{e.d(t,{F:()=>i});var r=e(67897),o=e(15441),a=e(30565),s=e(28189);const i=(0,e(70929).op)({atan2_:function(n,t){let e=(0,s.YT)(n,"a","atan2"),i=(0,s.YT)(t,"b","atan2");[e,i]=(0,a.h0)(e,i);const u={a:e,b:i};return r.T2.runKernel(o.lxb,u)}})},63774:(n,t,e)=>{e.d(t,{r:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({atanh_:function(n){const t={x:(0,a.YT)(n,"x","atanh")};return r.T2.runKernel(o.zP9,t)}})},53909:(n,t,e)=>{e.d(t,{$:()=>p});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(29809),u=e(47195),l=e(70929),c=e(62302);const p=(0,l.op)({avgPool_:function(n,t,e,l,p){const h=(0,a.YT)(n,"x","avgPool","float32");s.vA(u.G0(e,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`));let d=h,f=!1;3===h.rank&&(f=!0,d=(0,c.t)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),s.vA(4===d.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${d.rank}.`)),u.s_("avgPool",l,p);const m={x:d},g={filterSize:t,strides:e,pad:l,dimRoundingMode:p};let v=r.T2.runKernel(o.ho8,m,g);return v=(0,i.w)(v,h.dtype),f?(0,c.t)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},53855:(n,t,e)=>{e.d(t,{s:()=>p});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(29809),u=e(47195),l=e(70929),c=e(62302);const p=(0,l.op)({avgPool3d_:function(n,t,e,l,p,h="NDHWC"){const d=(0,a.YT)(n,"x","avgPool3d","float32");let f=d,m=!1;4===d.rank&&(m=!0,f=(0,c.t)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),s.vA(5===f.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${f.rank}.`)),s.vA("NDHWC"===h,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${h}`)),s.vA("number"==typeof e&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,(()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`)),(0,u.s_)("avgPool3d",l,p);const g={x:f},v={filterSize:t,strides:e,pad:l,dimRoundingMode:p,dataFormat:h};let b=r.T2.runKernel(o.cS,g,v);return b=(0,i.w)(b,f.dtype),m?(0,c.t)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}})},47850:(n,t,e)=>{e.d(t,{k:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195),u=e(70929),l=e(62302);const c=(0,u.op)({avgPool3dGrad_:function(n,t,e,u,c,p){const h=(0,a.YT)(n,"dy","avgPool3dGrad"),d=(0,a.YT)(t,"input","avgPool3dGrad");let f=h,m=d,g=!1;4===d.rank&&(g=!0,f=(0,l.t)(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]]),m=(0,l.t)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),s.vA(5===f.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`)),s.vA(5===m.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${m.rank}.`)),(0,i.s_)("avgPool3dGrad",c,p);const v={dy:f,input:m},b={filterSize:e,strides:u,pad:c,dimRoundingMode:p},k=r.T2.runKernel(o.wwC,v,b);return g?(0,l.t)(k,[k.shape[1],k.shape[2],k.shape[3],k.shape[4]]):k}})},27160:(n,t,e)=>{e.d(t,{$:()=>l});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(70929),u=e(62302);const l=(0,i.op)({avgPoolGrad_:function(n,t,e,i,l){const c=(0,a.YT)(n,"dy","avgPoolGrad"),p=(0,a.YT)(t,"input","avgPoolGrad");s.vA(p.rank===c.rank,(()=>`Rank of input (${p.rank}) does not match rank of dy (${c.rank})`));let h=p,d=c,f=!1;3===p.rank&&(f=!0,h=(0,u.t)(p,[1,p.shape[0],p.shape[1],p.shape[2]]),d=(0,u.t)(c,[1,c.shape[0],c.shape[1],c.shape[2]])),s.vA(4===d.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${d.rank}.`)),s.vA(4===h.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${h.rank}.`));const m={dy:d,input:h},g={filterSize:e,strides:i,pad:l},v=r.T2.runKernel(o.VCH,m,g);return f?(0,u.t)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},21078:(n,t,e)=>{e.d(t,{Em:()=>l,SM:()=>i,WC:()=>u,WH:()=>o,aF:()=>a,fK:()=>p,gx:()=>c,lb:()=>s});var r=e(45119);function o(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function a(n,t,e){const r=n.length+t.length,o=[];let a=0,s=0;for(let i=0;i<r;i++)-1===e.indexOf(i)?o.push(n[a++]):o.push(t[s++]);return o}function s(n,t){const e=[],r=n.length;for(let o=0;o<r;o++)-1===t.indexOf(o)&&e.push(n[o]);return[e,t.map((t=>n[t]))]}function i(n,t){return a(n,t.map((n=>1)),t)}function u(n,t,e){r.vA(o(t,e),(()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`))}function l(n,t){if(o(n,t))return null;const e=[];for(let r=0;r<t;++r)-1===n.indexOf(r)&&e.push(r);return n.forEach((n=>e.push(n))),e}function c(n){return n.map(((n,t)=>[t,n])).sort(((n,t)=>n[1]-t[1])).map((n=>n[0]))}function p(n,t){const e=[];for(let r=t-n;r<t;++r)e.push(r);return e}},69906:(n,t,e)=>{e.d(t,{l:()=>h});var r=e(28189),o=e(37523),a=e(25030),s=e(65703),i=e(9258),u=e(70929),l=e(28968),c=e(17986),p=e(57311);const h=(0,u.op)({basicLSTMCell_:function(n,t,e,u,h,d){const f=(0,r.YT)(n,"forgetBias","basicLSTMCell"),m=(0,r.YT)(t,"lstmKernel","basicLSTMCell"),g=(0,r.YT)(e,"lstmBias","basicLSTMCell"),v=(0,r.YT)(u,"data","basicLSTMCell"),b=(0,r.YT)(h,"c","basicLSTMCell"),k=(0,r.YT)(d,"h","basicLSTMCell"),T=(0,a.x)([v,k],1),x=(0,s.N)(T,m),E=(0,o.W)(x,g),$=E.shape[0],A=E.shape[1]/4,y=[$,A],Y=(0,c.d)(E,[0,0],y),_=(0,c.d)(E,[0,A],y),w=(0,c.d)(E,[0,2*A],y),N=(0,c.d)(E,[0,3*A],y),S=(0,o.W)((0,i.l)((0,l.r)(Y),(0,p.y)(_)),(0,i.l)(b,(0,l.r)((0,o.W)(f,w))));return[S,(0,i.l)((0,p.y)(S),(0,l.r)(N))]}})},69772:(n,t,e)=>{e.d(t,{G:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({batchToSpaceND_:function(n,t,e){const i=(0,a.YT)(n,"x","batchToSpaceND"),u=t.reduce(((n,t)=>n*t));s.vA(i.rank>=1+t.length,(()=>`input rank is ${i.rank} but should be > than blockShape.length ${t.length}`)),s.vA(e.length===t.length,(()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`)),s.vA(i.shape[0]%u==0,(()=>`input tensor batch is ${i.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${u}`));const l={x:i},c={blockShape:t,crops:e};return r.T2.runKernel(o.Ik2,l,c)}})},9160:(n,t,e)=>{e.d(t,{$:()=>u});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(62302);const u=(0,e(70929).op)({batchNorm_:function(n,t,e,u,l,c){null==c&&(c=.001);const p=(0,a.YT)(n,"x","batchNorm"),h=(0,a.YT)(t,"mean","batchNorm"),d=(0,a.YT)(e,"variance","batchNorm");let f,m;null!=l&&(f=(0,a.YT)(l,"scale","batchNorm")),null!=u&&(m=(0,a.YT)(u,"offset","batchNorm")),s.vA(h.rank===d.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),s.vA(null==m||h.rank===m.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),s.vA(null==f||h.rank===f.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const g={x:function(n){let t;return t=0===n.rank||1===n.rank?(0,i.t)(n,[1,1,1,n.size]):2===n.rank?(0,i.t)(n,[1,1,n.shape[0],n.shape[1]]):3===n.rank?(0,i.t)(n,[1,n.shape[0],n.shape[1],n.shape[2]]):n,t}(p),scale:f,offset:m,mean:h,variance:d},v={varianceEpsilon:c},b=r.T2.runKernel(o.i5R,g,v);return(0,i.t)(b,p.shape)}})},13620:(n,t,e)=>{e.d(t,{B:()=>s});var r=e(28189),o=e(45119),a=e(9160);const s=(0,e(70929).op)({batchNorm2d_:function(n,t,e,s,i,u){const l=(0,r.YT)(n,"x","batchNorm"),c=(0,r.YT)(t,"mean","batchNorm"),p=(0,r.YT)(e,"variance","batchNorm");let h,d;return null!=i&&(h=(0,r.YT)(i,"scale","batchNorm")),null!=s&&(d=(0,r.YT)(s,"offset","batchNorm")),o.vA(2===l.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${l.rank}.`)),o.vA(2===c.rank||1===c.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${c.rank}.`)),o.vA(2===p.rank||1===p.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${p.rank}.`)),null!=h&&o.vA(2===h.rank||1===h.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${h.rank}.`)),null!=d&&o.vA(2===d.rank||1===d.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`)),(0,a.$)(l,c,p,d,h,u)}})},76241:(n,t,e)=>{e.d(t,{k:()=>s});var r=e(28189),o=e(45119),a=e(9160);const s=(0,e(70929).op)({batchNorm3d_:function(n,t,e,s,i,u){const l=(0,r.YT)(n,"x","batchNorm"),c=(0,r.YT)(t,"mean","batchNorm"),p=(0,r.YT)(e,"variance","batchNorm");let h,d;return null!=i&&(h=(0,r.YT)(i,"scale","batchNorm")),null!=s&&(d=(0,r.YT)(s,"offset","batchNorm")),o.vA(3===l.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${l.rank}.`)),o.vA(3===c.rank||1===c.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${c.rank}.`)),o.vA(3===p.rank||1===p.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${p.rank}.`)),null!=h&&o.vA(3===h.rank||1===h.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${h.rank}.`)),null!=d&&o.vA(3===d.rank||1===d.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`)),(0,a.$)(l,c,p,d,h,u)}})},27874:(n,t,e)=>{e.d(t,{T:()=>s});var r=e(28189),o=e(45119),a=e(9160);const s=(0,e(70929).op)({batchNorm4d_:function(n,t,e,s,i,u){const l=(0,r.YT)(n,"x","batchNorm"),c=(0,r.YT)(t,"mean","batchNorm"),p=(0,r.YT)(e,"variance","batchNorm");let h,d;return null!=i&&(h=(0,r.YT)(i,"scale","batchNorm")),null!=s&&(d=(0,r.YT)(s,"offset","batchNorm")),o.vA(4===l.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${l.rank}.`)),o.vA(4===c.rank||1===c.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${c.rank}.`)),o.vA(4===p.rank||1===p.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${p.rank}.`)),null!=h&&o.vA(4===h.rank||1===h.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${h.rank}.`)),null!=d&&o.vA(4===d.rank||1===d.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`)),(0,a.$)(l,c,p,d,h,u)}})},40758:(n,t,e)=>{e.d(t,{H:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({bincount_:function(n,t,e){const i=(0,a.YT)(n,"x","bincount"),u=(0,a.YT)(t,"weights","bincount");s.vA("int32"===i.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${i.dtype}`)),s.vA(e>=0,(()=>`size must be non-negative, but got ${e}.`)),s.vA(u.size===i.size||0===u.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${i.shape}, weights shape: ${u.shape}.`));const l={x:i,weights:u},c={size:e};return r.T2.runKernel(o.N4F,l,c)}})},33007:(n,t,e)=>{e.d(t,{f:()=>l});var r=e(28189),o=e(45119),a=e(48229),s=e(62302),i=e(5932),u=e(44271);const l=async function(n,t,e){const l=(0,r.YT)(n,"tensor","boolMask"),c=(0,r.YT)(t,"mask","boolMask","bool"),p=null==e?0:e,h=c.rank,d=l.shape;o.vA(h>0,(()=>"mask cannot be scalar")),o.O3(d.slice(p,p+h),c.shape,"mask's shape must match the first K dimensions of tensor's shape,");let f=1;for(let n=p;n<p+h;n++)f*=d[n];const m=d.slice(0,p).concat([f],d.slice(p+h)),g=(0,s.t)(l,m),v=(0,s.t)(c,[-1]),b=await(0,u.Y)(v),k=(0,i.r)(b,[1]),T=(0,a.k)(g,k,p);return n!==l&&l.dispose(),t!==c&&c.dispose(),k.dispose(),g.dispose(),v.dispose(),b.dispose(),T}},17367:(n,t,e)=>{e.d(t,{R:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({broadcastArgs_:function(n,t){const e=(0,a.YT)(n,"s0","broadcastArgs","int32"),s=(0,a.YT)(t,"s1","broadcastArgs","int32");if(1!==e.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${e.rank}`);if(1!==s.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const i={s0:e,s1:s};return r.T2.runKernel(o.vj7,i)}})},63567:(n,t,e)=>{e.d(t,{h:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(70125),u=e(70929),l=e(62302);const c=(0,u.op)({broadcastTo_:function(n,t){let e=(0,a.YT)(n,"broadcastTo","x");const u=e.shape;if((0,s.SA)(t),t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){const n=e.shape.slice();for(;n.length<t.length;)n.unshift(1);e=(0,l.t)(e,n)}const c=e.shape,p=Array.from(t);for(let n=t.length-1;n>=0;n--)if(c[n]===t[n])p[n]=1;else if(1!==e.shape[n])throw new Error(`broadcastTo(): [${u}] cannot be broadcast to [${t}].`);if(0===p.map(((n,t)=>n>1?t:-1)).filter((n=>n>=0)).length)return(0,i.o)(e);const h={x:e},d={reps:p};return r.T2.runKernel(o.FAs,h,d)}})},62198:(n,t,e)=>{function r(n,t){const e=n.length,r=[];for(let o=0;o<e;o++){const a=e-1-o,s=n[a]||1;(t[t.length-1-o]||1)>1&&1===s&&r.unshift(a)}return r}function o(n,t){const e=[];for(let r=0;r<t.length;r++){const o=n[n.length-r-1],a=t.length-r-1,s=t[a];(null==o||1===o&&s>1)&&e.unshift(a)}return e}function a(n,t){const e=[],r=Math.max(n.length,t.length);for(let o=0;o<r;o++){let r=n[n.length-o-1];null==r&&(r=1);let a=t[t.length-o-1];if(null==a&&(a=1),1===r)e.unshift(a);else if(1===a)e.unshift(r);else{if(r!==a)throw Error(`Operands could not be broadcast together with shapes ${n} and ${t}.`);e.unshift(r)}}return e}e.r(t),e.d(t,{assertAndGetBroadcastShape:()=>a,getBroadcastDims:()=>r,getReductionAxes:()=>o})},27836:(n,t,e)=>{e.r(t),e.d(t,{fromPixels:()=>g,fromPixelsAsync:()=>f,toPixels:()=>m});var r=e(67897),o=e(46574),a=e(15441),s=e(37074),i=e(50259),u=e(28189),l=e(29809),c=e(70929),p=e(42768);let h;function d(n,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==n)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let e=!1,o=!1,i=!1,u=!1,l=!1,c=!1;if(n.data instanceof Uint8Array)e=!0;else if("undefined"!=typeof ImageData&&n instanceof ImageData)o=!0;else if("undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement)u=!0;else if(null!=n.getContext)l=!0;else{if(!("undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);c=!0}if(null!=(0,s._5)(a.awo,r.T2.backendName)){const e={pixels:n},o={numChannels:t};return r.T2.runKernel(a.awo,e,o)}const[d,f]=i?[n.videoWidth,n.videoHeight]:[n.width,n.height];let m,g;if(l)m=n.getContext("2d").getImageData(0,0,d,f).data;else if(o||e)m=n.data;else if(u||i||c){if(null==h)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");h=new OffscreenCanvas(1,1).getContext("2d")}else h=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});h.canvas.width=d,h.canvas.height=f,h.drawImage(n,0,0,d,f),m=h.getImageData(0,0,d,f).data}if(4===t)g=new Int32Array(m);else{const n=d*f;g=new Int32Array(n*t);for(let e=0;e<n;e++)for(let n=0;n<t;++n)g[e*t+n]=m[4*e+n]}const v=[f,d,t];return(0,p.$)(g,v,"int32")}async function f(n,t=3){let e=null;if((0,o._K)().getBool("WRAP_TO_IMAGEBITMAP")&&function(n){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(n instanceof ImageBitmap)&&function(n){return null!=n&&0!==n.width&&0!==n.height}(n)&&!function(n){return null!=n&&n.data instanceof Uint8Array}(n)}(n)){let t;try{t=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch(n){t=null}e=null!=t&&t.width===n.width&&t.height===n.height?t:n}else e=n;return d(e,t)}async function m(n,t){let e=(0,u.YT)(n,"img","toPixels");if(!(n instanceof i.qY)){const n=e;e=(0,l.w)(n,"int32"),n.dispose()}if(2!==e.rank&&3!==e.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${e.rank}.`);const[r,o]=e.shape.slice(0,2),a=2===e.rank?1:e.shape[2];if(a>4||2===a)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${a}`);if("float32"!==e.dtype&&"int32"!==e.dtype)throw new Error(`Unsupported type for toPixels: ${e.dtype}. Please use float32 or int32 tensors.`);const s=await e.data(),c="float32"===e.dtype?255:1,p=new Uint8ClampedArray(o*r*4);for(let n=0;n<r*o;++n){const t=[0,0,0,255];for(let r=0;r<a;r++){const o=s[n*a+r];if("float32"===e.dtype){if(o<0||o>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${o}.`)}else if("int32"===e.dtype&&(o<0||o>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${o}.`);1===a?(t[0]=o*c,t[1]=o*c,t[2]=o*c):t[r]=o*c}const r=4*n;p[r+0]=Math.round(t[0]),p[r+1]=Math.round(t[1]),p[r+2]=Math.round(t[2]),p[r+3]=Math.round(t[3])}if(null!=t){t.width=o,t.height=r;const n=t.getContext("2d"),e=new ImageData(p,o,r);n.putImageData(e,0,0)}return e!==n&&e.dispose(),p}const g=(0,c.op)({fromPixels_:d})},448:(n,t,e)=>{e.d(t,{r:()=>a});var r=e(50259),o=e(45119);function a(n,t="float32",e){return t=t||"float32",o.SA(n),new r.yl(n,t,e)}},29809:(n,t,e)=>{e.d(t,{w:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({cast_:function(n,t){const e=(0,a.YT)(n,"x","cast");if(!s.xn(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==e.dtype||"string"!==t&&"string"===e.dtype)throw new Error("Only strings can be casted to strings");const i={x:e},u={dtype:t};return r.T2.runKernel(o.KXH,i,u)}})},30855:(n,t,e)=>{e.d(t,{m:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({ceil_:function(n){const t={x:(0,a.YT)(n,"x","ceil","float32")};return r.T2.runKernel(o.QDP,t)}})},96928:(n,t,e)=>{e.d(t,{z:()=>u});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(96111);const u=(0,e(70929).op)({clipByValue_:function(n,t,e){const u=(0,a.YT)(n,"x","clipByValue");if(s.vA(t<=e,(()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`)),t===e)return(0,i.G)(u.shape,t,u.dtype);const l={x:u},c={clipValueMin:t,clipValueMax:e};return r.T2.runKernel(o.vaV,l,c)}})},70125:(n,t,e)=>{e.d(t,{o:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({clone_:function(n){const t={x:(0,a.YT)(n,"x","clone","string_or_numeric")};return r.T2.runKernel(o.lzr,t)}})},37148:(n,t,e)=>{e.d(t,{f:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({complex_:function(n,t){const e=(0,a.YT)(n,"real","complex"),i=(0,a.YT)(t,"imag","complex");s.O3(e.shape,i.shape,`real and imag shapes, ${e.shape} and ${i.shape}, must match in call to tf.complex().`);const u={real:e,imag:i};return r.T2.runKernel(o.pr3,u)}})},25030:(n,t,e)=>{e.d(t,{x:()=>u});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(70125);const u=(0,e(70929).op)({concat_:function(n,t=0){(0,s.vA)(n.length>=1,(()=>"Pass at least one tensor to concat"));const e=(0,a.j1)(n,"tensors","concat","string_or_numeric");if("complex64"===e[0].dtype&&e.forEach((n=>{if("complex64"!==n.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${n.dtype}. `)})),1===e.length)return(0,i.o)(e[0]);const u=e,l={axis:t};return r.T2.runKernel(o.$dB,u,l)}})},46520:(n,t,e)=>{e.d(t,{I:()=>o});var r=e(25030);const o=(0,e(70929).op)({concat1d_:function(n){return(0,r.x)(n,0)}})},19879:(n,t,e)=>{e.d(t,{R:()=>o});var r=e(25030);const o=(0,e(70929).op)({concat2d_:function(n,t){return(0,r.x)(n,t)}})},55530:(n,t,e)=>{e.d(t,{O:()=>o});var r=e(25030);const o=(0,e(70929).op)({concat3d_:function(n,t){return(0,r.x)(n,t)}})},60569:(n,t,e)=>{e.d(t,{P:()=>o});var r=e(25030);const o=(0,e(70929).op)({concat4d_:function(n,t){return(0,r.x)(n,t)}})},12789:(n,t,e)=>{e.d(t,{L:()=>o,P:()=>a});var r=e(45119);function o(n,t){const e=n[0].length;n.forEach(((n,t)=>{r.vA(n.length===e,(()=>`Error in concat${e}D: rank of tensors[${t}] must be the same as the rank of the rest (${e})`))})),r.vA(t>=0&&t<e,(()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`));const o=n[0];n.forEach(((n,a)=>{for(let s=0;s<e;s++)r.vA(s===t||n[s]===o[s],(()=>`Error in concat${e}D: Shape of tensors[${a}] (${n}) does not match the shape of the rest (${o}) along the non-concatenated axis ${a}.`))}))}function a(n,t){const e=n[0].slice();for(let r=1;r<n.length;r++)e[t]+=n[r][t];return e}},3701:(n,t,e)=>{e.d(t,{k:()=>l});var r=e(28189),o=e(45119),a=e(28794),s=e(47195),i=e(70929),u=e(62302);const l=(0,i.op)({conv1d_:function(n,t,e,i,l="NWC",c=1,p){const h=(0,r.YT)(n,"x","conv1d"),d=(0,r.YT)(t,"filter","conv1d");let f=h,m=!1;2===h.rank&&(m=!0,f=(0,u.t)(h,[1,h.shape[0],h.shape[1]])),o.vA(3===f.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${f.rank}.`)),o.vA(3===d.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${d.rank}.`)),s.s_("conv1d",i,p),o.vA(f.shape[2]===d.shape[1],(()=>`Error in conv1d: depth of input (${f.shape[2]}) must match input depth for filter ${d.shape[1]}.`)),o.vA(s.G0(e,c),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${c}'`)),o.vA(s.qk(c),(()=>"Error in conv1D: Dilated rates should be larger than 0.")),o.vA(s.qk(e),(()=>"Error in conv1D: Stride should be larger than 0.")),o.vA("NWC"===l,(()=>`Error in conv1d: got dataFormat of ${l} but only NWC is currently supported.`));const g=(0,u.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]]),v=(0,u.t)(f,[f.shape[0],1,f.shape[1],f.shape[2]]),b=[1,e],k=[1,c],T=(0,a.X)(v,g,b,i,"NHWC",k,p);return m?(0,u.t)(T,[T.shape[2],T.shape[3]]):(0,u.t)(T,[T.shape[0],T.shape[2],T.shape[3]])}})},28794:(n,t,e)=>{e.d(t,{X:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195),u=e(70929),l=e(62302);const c=(0,u.op)({conv2d_:function(n,t,e,u,c="NHWC",p=[1,1],h){const d=(0,a.YT)(n,"x","conv2d","float32"),f=(0,a.YT)(t,"filter","conv2d","float32");let m=d,g=!1;3===d.rank&&(g=!0,m=(0,l.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),s.vA(4===m.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${m.rank}.`)),s.vA(4===f.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${f.rank}.`)),i.s_("conv2d",u,h);const v="NHWC"===c?m.shape[3]:m.shape[1];s.vA(v===f.shape[2],(()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${f.shape[2]}.`)),s.vA(i.G0(e,p),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${p}'`)),s.vA(i.qk(p),(()=>"Error in conv2D: Dilated rates should be larger than 0.")),s.vA(i.qk(e),(()=>"Error in conv2D: Strides should be larger than 0."));const b={x:m,filter:f},k={strides:e,pad:u,dataFormat:c,dilations:p,dimRoundingMode:h},T=r.T2.runKernel(o.p2J,b,k);return g?(0,l.t)(T,[T.shape[1],T.shape[2],T.shape[3]]):T}})},25248:(n,t,e)=>{e.d(t,{H:()=>l});var r=e(67897),o=e(15441),a=e(45119),s=e(47195),i=e(70929),u=e(62302);const l=(0,i.op)({conv2DBackpropFilter_:function(n,t,e,i,l,c="NHWC",p){let h=n;3===n.rank&&(h=(0,u.t)(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let d=t;3===d.rank&&(d=(0,u.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),a.vA(4===h.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${h.shape}.`)),a.vA(4===d.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${d.shape}.`)),a.vA(4===e.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`));const f="NHWC"===c?h.shape[3]:h.shape[1],m="NHWC"===c?d.shape[3]:d.shape[1];a.vA(f===e[2],(()=>`Error in conv2dDerFilter: depth of input ${f}) must match input depth in filter (${e[2]}.`)),a.vA(m===e[3],(()=>`Error in conv2dDerFilter: depth of dy (${m}) must match output depth for filter (${e[3]}).`)),s.s_("conv2dDerFilter",l,p);const g={x:h,dy:d},v={strides:i,pad:l,dataFormat:c,dimRoundingMode:p,filterShape:e};return r.T2.runKernel(o.rFm,g,v)}})},80252:(n,t,e)=>{e.d(t,{v:()=>l});var r=e(67897),o=e(15441),a=e(45119),s=e(47195),i=e(70929),u=e(62302);const l=(0,i.op)({conv2DBackpropInput_:function(n,t,e,i,l,c="NHWC",p){a.vA(n.length===t.rank,(()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`));let h=n,d=t,f=!1;3===t.rank&&(f=!0,d=(0,u.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),h=[1,n[0],n[1],n[2]]),a.vA(4===h.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${h.length}.`)),a.vA(4===d.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${d.rank}`)),a.vA(4===e.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`));const m="NHWC"===c?h[3]:h[1],g="NHWC"===c?d.shape[3]:d.shape[1];a.vA(m===e.shape[2],(()=>`Error in conv2dDerInput: depth of input (${m}) must match input depth for filter ${e.shape[2]}.`)),a.vA(g===e.shape[3],(()=>`Error in conv2dDerInput: depth of output (${g}) must match output depth for filter ${e.shape[3]}.`)),s.s_("conv2dDerInput",l,p);const v={dy:d,filter:e},b={strides:i,pad:l,dataFormat:c,dimRoundingMode:p,inputShape:h},k=r.T2.runKernel(o.jfg,v,b);return f?(0,u.t)(k,[k.shape[1],k.shape[2],k.shape[3]]):k}})},41106:(n,t,e)=>{e.d(t,{w:()=>a});var r=e(28189),o=e(80252);const a=(0,e(70929).op)({conv2dTranspose_:function(n,t,e,a,s,i){const u=(0,r.YT)(n,"x","conv2dTranspose"),l=(0,r.YT)(t,"filter","conv2dTranspose");return(0,o.v)(e,u,l,a,s,"NHWC",i)}})},90167:(n,t,e)=>{e.d(t,{I:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195),u=e(70929),l=e(62302);const c=(0,u.op)({conv3d_:function(n,t,e,u,c="NDHWC",p=[1,1,1]){const h=(0,a.YT)(n,"x","conv3d"),d=(0,a.YT)(t,"filter","conv3d");let f=h,m=!1;4===h.rank&&(m=!0,f=(0,l.t)(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),s.vA(5===f.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${f.rank}.`)),s.vA(5===d.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${d.rank}.`)),s.vA(f.shape[4]===d.shape[3],(()=>`Error in conv3d: depth of input (${f.shape[4]}) must match input depth for filter ${d.shape[3]}.`)),s.vA((0,i.G0)(e,p),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${p}'`)),s.vA("NDHWC"===c,(()=>`Error in conv3d: got dataFormat of ${c} but only NDHWC is currently supported.`)),s.vA((0,i.qk)(p),(()=>"Error in conv3D: Dilated rates should be larger than 0.")),s.vA((0,i.qk)(e),(()=>"Error in conv3D: Strides should be larger than 0."));const g={x:f,filter:d},v={strides:e,pad:u,dataFormat:c,dilations:p},b=r.T2.runKernel(o.A1h,g,v);return m?(0,l.t)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}})},65281:(n,t,e)=>{e.d(t,{_:()=>u});var r=e(67897),o=e(15441),a=e(45119),s=e(70929),i=e(62302);const u=(0,s.op)({conv3DBackpropFilter_:function(n,t,e,s,u){let l=n;4===n.rank&&(l=(0,i.t)(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let c=t;4===c.rank&&(c=(0,i.t)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),a.vA(5===l.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${l.shape}.`)),a.vA(5===c.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${c.shape}.`)),a.vA(5===e.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`)),a.vA(l.shape[4]===e[3],(()=>`Error in conv3dDerFilter: depth of input ${l.shape[4]}) must match input depth in filter (${e[3]}.`)),a.vA(c.shape[4]===e[4],(()=>`Error in conv3dDerFilter: depth of dy (${c.shape[4]}) must match output depth for filter (${e[4]}).`));const p={x:l,dy:c},h={strides:s,pad:u,filterShape:e};return r.T2.runKernel(o.iGz,p,h)}})},31895:(n,t,e)=>{e.d(t,{c:()=>u});var r=e(67897),o=e(15441),a=e(45119),s=e(70929),i=e(62302);const u=(0,s.op)({conv3DBackpropInput_:function(n,t,e,s,u){a.vA(n.length===t.rank,(()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`));let l=n,c=t,p=!1;4===t.rank&&(p=!0,c=(0,i.t)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),l=[1,n[0],n[1],n[2],n[3]]);const h=l[4],d=c.shape[4];a.vA(5===l.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${l.length}.`)),a.vA(5===c.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${c.rank}`)),a.vA(5===e.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`)),a.vA(h===e.shape[3],(()=>`Error in conv3dDerInput: depth of input (${h}) must match input depth for filter ${e.shape[3]}.`)),a.vA(d===e.shape[4],(()=>`Error in conv3dDerInput: depth of output (${d}) must match output depth for filter ${e.shape[4]}.`));const f={dy:c,filter:e},m={pad:u,strides:s,inputShape:l},g=r.T2.runKernel(o.gC7,f,m);return p?(0,i.t)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},41655:(n,t,e)=>{e.d(t,{j:()=>a});var r=e(28189),o=e(31895);const a=(0,e(70929).op)({conv3dTranspose_:function(n,t,e,a,s){const i=(0,r.YT)(n,"x","conv3dTranspose"),u=(0,r.YT)(t,"filter","conv3dTranspose");return(0,o.c)(e,i,u,a,s)}})},47195:(n,t,e)=>{e.d(t,{$Q:()=>v,Dh:()=>f,E6:()=>a,G0:()=>m,G8:()=>l,YQ:()=>o,l5:()=>s,p$:()=>u,qk:()=>g,s_:()=>b,uf:()=>i});var r=e(45119);function o(n,t,e,r,o="NHWC",a){return i(n,[...t,n[3]],e,a,r,null,null,v(o))}function a(n,t,e,r,o,a,s="channelsLast"){const[u,l]=c(t);let p;if("channelsLast"===s)p=[u,l,n[3],n[3]];else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);p=[u,l,n[1],n[1]]}return i(n,p,e,r,o,a,!1,s)}function s(n,t,e,r,o,a,s="NDHWC"){const[i,l,c]=p(t);let h,d;if("NDHWC"===s)d="channelsLast",h=[i,l,c,n[4],n[4]];else{if("NCDHW"!==s)throw new Error(`Unknown dataFormat ${s}`);d="channelsFirst",h=[i,l,c,n[1],n[1]]}return u(n,h,e,r,o,!1,d,a)}function i(n,t,e,r,o,a,s=!1,i="channelsLast"){let[u,p,f,m]=[-1,-1,-1,-1];if("channelsLast"===i)[u,p,f,m]=n;else{if("channelsFirst"!==i)throw new Error(`Unknown dataFormat ${i}`);[u,m,p,f]=n}const[g,v,,b]=t,[k,T]=c(e),[x,E]=c(r),$=h(g,x),A=h(v,E),{padInfo:y,outHeight:Y,outWidth:_}=function(n,t,e,r,o,a,s,i,u){let c,p,h;if("number"==typeof n){c={top:n,bottom:n,left:n,right:n,type:0===n?"VALID":"NUMBER"};const o=function(n,t,e,r,o){null==r&&(r=l(n,t,e));const a=n[1];return[d((n[0]-t+2*r)/e+1,o),d((a-t+2*r)/e+1,o)]}([t,e],a,r,n,i);p=o[0],h=o[1]}else if("same"===n){p=Math.ceil(t/r),h=Math.ceil(e/o);const n=Math.max(0,(p-1)*r+a-t),i=Math.max(0,(h-1)*o+s-e),u=Math.floor(n/2),l=n-u,d=Math.floor(i/2);c={top:u,bottom:l,left:d,right:i-d,type:"SAME"}}else if("valid"===n)c={top:0,bottom:0,left:0,right:0,type:"VALID"},p=Math.ceil((t-a+1)/r),h=Math.ceil((e-s+1)/o);else{if("object"!=typeof n)throw Error(`Unknown padding parameter: ${n}`);{const l="channelsLast"===u?n[1][0]:n[2][0],f="channelsLast"===u?n[1][1]:n[2][1],m="channelsLast"===u?n[2][0]:n[3][0],g="channelsLast"===u?n[2][1]:n[3][1];c={top:l,bottom:f,left:m,right:g,type:0===l&&0===f&&0===m&&0===g?"VALID":"EXPLICIT"},p=d((t-a+l+f)/r+1,i),h=d((e-s+m+g)/o+1,i)}}return{padInfo:c,outHeight:p,outWidth:h}}(o,p,f,k,T,$,A,a,i),w=s?b*m:b;let N;return"channelsFirst"===i?N=[u,w,Y,_]:"channelsLast"===i&&(N=[u,Y,_,w]),{batchSize:u,dataFormat:i,inHeight:p,inWidth:f,inChannels:m,outHeight:Y,outWidth:_,outChannels:w,padInfo:y,strideHeight:k,strideWidth:T,filterHeight:g,filterWidth:v,effectiveFilterHeight:$,effectiveFilterWidth:A,dilationHeight:x,dilationWidth:E,inShape:n,outShape:N,filterShape:t}}function u(n,t,e,r,o,a=!1,s="channelsLast",i){let[u,c,f,m,g]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[u,c,f,m,g]=n;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[u,g,c,f,m]=n}const[v,b,k,,T]=t,[x,E,$]=p(e),[A,y,Y]=p(r),_=h(v,A),w=h(b,y),N=h(k,Y),{padInfo:S,outDepth:D,outHeight:M,outWidth:C}=function(n,t,e,r,o,a,s,i,u,c,p){let h,f,m,g;if("valid"===n&&(n=0),"number"==typeof n){h={top:n,bottom:n,left:n,right:n,front:n,back:n,type:0===n?"VALID":"NUMBER"};const v=function(n,t,e,r,o,a){null==o&&(o=l(n,t[0],r[0]));const s=[0,0,0,1];for(let e=0;e<3;e++)n[e]+2*o>=t[e]&&(s[e]=d((n[e]-t[e]+2*o)/r[e]+1,a));return s}([t,e,r,1],[i,u,c],0,[o,a,s],n,p);f=v[0],m=v[1],g=v[2]}else{if("same"!==n)throw Error(`Unknown padding parameter: ${n}`);{f=Math.ceil(t/o),m=Math.ceil(e/a),g=Math.ceil(r/s);const n=(f-1)*o+i-t,l=(m-1)*a+u-e,p=(g-1)*s+c-r,d=Math.floor(n/2),v=n-d,b=Math.floor(l/2),k=l-b,T=Math.floor(p/2);h={top:b,bottom:k,left:T,right:p-T,front:d,back:v,type:"SAME"}}}return{padInfo:h,outDepth:f,outHeight:m,outWidth:g}}(o,c,f,m,x,E,$,_,w,N,i),K=a?T*g:T;let W;return"channelsFirst"===s?W=[u,K,D,M,C]:"channelsLast"===s&&(W=[u,D,M,C,K]),{batchSize:u,dataFormat:s,inDepth:c,inHeight:f,inWidth:m,inChannels:g,outDepth:D,outHeight:M,outWidth:C,outChannels:K,padInfo:S,strideDepth:x,strideHeight:E,strideWidth:$,filterDepth:v,filterHeight:b,filterWidth:k,effectiveFilterDepth:_,effectiveFilterHeight:w,effectiveFilterWidth:N,dilationDepth:A,dilationHeight:y,dilationWidth:Y,inShape:n,outShape:W,filterShape:t}}function l(n,t,e,r=1){const o=h(t,r);return Math.floor((n[0]*(e-1)-e+o)/2)}function c(n){return"number"==typeof n?[n,n,n]:2===n.length?[n[0],n[1],1]:n}function p(n){return"number"==typeof n?[n,n,n]:n}function h(n,t){return t<=1?n:n+(n-1)*(t-1)}function d(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function f(n){const[t,e,r]=c(n);return 1===t&&1===e&&1===r}function m(n,t){return f(n)||f(t)}function g(n){return c(n).every((n=>n>0))}function v(n){if("NHWC"===n)return"channelsLast";if("NCHW"===n)return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function b(n,t,e){if(null!=e){if("string"==typeof t)throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);if("number"==typeof t)r.vA(r.E6(t),(()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`));else{if("object"!=typeof t)throw Error(`Error in ${n}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{r.vA(r.E6(t),(()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`))}))}))}}}},99907:(n,t,e)=>{e.d(t,{g:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({cos_:function(n){const t={x:(0,a.YT)(n,"x","cos","float32")};return r.T2.runKernel(o.Mn0,t)}})},27451:(n,t,e)=>{e.d(t,{y:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({cosh_:function(n){const t={x:(0,a.YT)(n,"x","cosh","float32")};return r.T2.runKernel(o.MnK,t)}})},10302:(n,t,e)=>{e.d(t,{L:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({cumprod_:function(n,t=0,e=!1,s=!1){const i={x:(0,a.YT)(n,"x","cumprod")},u={axis:t,exclusive:e,reverse:s};return r.T2.runKernel(o.jj_,i,u)}})},76808:(n,t,e)=>{e.d(t,{r:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({cumsum_:function(n,t=0,e=!1,s=!1){const i={x:(0,a.YT)(n,"x","cumsum")},u={axis:t,exclusive:e,reverse:s};return r.T2.runKernel(o.nY8,i,u)}})},77974:(n,t,e)=>{e.d(t,{a:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({denseBincount_:function(n,t,e,i=!1){const u=(0,a.YT)(n,"x","denseBincount"),l=(0,a.YT)(t,"weights","denseBincount");s.vA("int32"===u.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${u.dtype}`)),s.vA(u.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${u.rank}.`)),s.vA(e>=0,(()=>`size must be non-negative, but got ${e}.`)),s.vA(l.size===u.size||0===l.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${u.shape}, weights shape: ${l.shape}.`));const c={x:u,weights:l},p={size:e,binaryOutput:i};return r.T2.runKernel(o.wNW,c,p)}})},31216:(n,t,e)=>{e.d(t,{R:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({depthToSpace_:function(n,t,e="NHWC"){const i=(0,a.YT)(n,"x","depthToSpace","float32"),u="NHWC"===e?i.shape[1]:i.shape[2],l="NHWC"===e?i.shape[2]:i.shape[3],c="NHWC"===e?i.shape[3]:i.shape[1];s.vA(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),s.vA(u*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${u} and ${t}  for depthToSpace with input shape\n    ${i.shape}`)),s.vA(l*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${l} and ${t} for depthToSpace with input shape\n        ${i.shape}`)),s.vA(c%(t*t)==0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${c} for depthToSpace with input shape ${i.shape}`));const p={x:i},h={blockSize:t,dataFormat:e};return r.T2.runKernel(o.TMz,p,h)}})},10676:(n,t,e)=>{e.d(t,{G:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195),u=e(70929),l=e(62302);const c=(0,u.op)({depthwiseConv2d_:function(n,t,e,u,c="NHWC",p=[1,1],h){const d=(0,a.YT)(n,"x","depthwiseConv2d","float32"),f=(0,a.YT)(t,"filter","depthwiseConv2d","float32");let m=d,g=!1;3===d.rank&&(g=!0,m=(0,l.t)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),s.vA(4===m.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`)),s.vA(4===f.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`));const v="NHWC"===c?m.shape[3]:m.shape[1];s.vA(v===f.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${v}) must match the inChannels dimension in filter ${f.shape[2]}.`)),i.s_("depthwiseConv2d",u,h);const b={x:m,filter:f},k={strides:e,pad:u,dataFormat:c,dilations:p,dimRoundingMode:h},T=r.T2.runKernel(o.tGH,b,k);return g?(0,l.t)(T,[T.shape[1],T.shape[2],T.shape[3]]):T}})},41890:(n,t,e)=>{e.d(t,{x:()=>i});var r=e(67897),o=e(15441),a=e(70929),s=e(62302);const i=(0,a.op)({depthwiseConv2dNativeBackpropFilter_:function(n,t,e,a,i,u=[1,1],l){let c=n;3===n.rank&&(c=(0,s.t)(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let p=t;3===p.rank&&(p=(0,s.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const h={x:c,dy:p},d={strides:a,pad:i,dimRoundingMode:l,dilations:u,filterShape:e};return r.T2.runKernel(o.X$8,h,d)}})},83134:(n,t,e)=>{e.d(t,{l:()=>i});var r=e(67897),o=e(15441),a=e(70929),s=e(62302);const i=(0,a.op)({depthwiseConv2dNativeBackpropInput_:function(n,t,e,a,i,u=[1,1],l){let c=t,p=!1;3===t.rank&&(p=!0,c=(0,s.t)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const h={dy:c,filter:e},d={strides:a,pad:i,dimRoundingMode:l,dilations:u,inputShape:n},f=r.T2.runKernel(o.nVu,h,d);return p?(0,s.t)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},10601:(n,t,e)=>{e.d(t,{s:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({diag_:function(n){const t={x:(0,a.YT)(n,"x","diag")};return r.T2.runKernel(o.ORI,t)}})},93002:(n,t,e)=>{e.d(t,{X:()=>l});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(70929),u=e(62302);const l=(0,i.op)({dilation2d_:function(n,t,e,i,l=[1,1],c="NHWC"){const p=(0,a.YT)(n,"x","dilation2d"),h=(0,a.YT)(t,"filter","dilation2d");s.vA(3===p.rank||4===p.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${p.rank}.`)),s.vA(3===h.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${h.rank}.`)),s.vA("NHWC"===c,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${c}`));let d=p,f=!1;3===p.rank&&(d=(0,u.t)(p,[1,p.shape[0],p.shape[1],p.shape[2]]),f=!0),s.vA(d.shape[3]===h.shape[2],(()=>`Error in dilation2d:  input and filter must have the same depth: ${d.shape[3]} vs ${h.shape[2]}`));const m={x:d,filter:h},g={strides:e,pad:i,dilations:l},v=r.T2.runKernel(o.jxD,m,g);return f?(0,u.t)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},89359:(n,t,e)=>{e.d(t,{y:()=>u});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(88991);const u=(0,e(70929).op)({div_:function(n,t){let e=(0,s.YT)(n,"a","div"),u=(0,s.YT)(t,"b","div");if([e,u]=(0,a.h0)(e,u),"int32"===e.dtype&&"int32"===u.dtype)return(0,i.w)(e,u);const l={a:e,b:u};return r.T2.runKernel(o.sDr,l,{})}})},919:(n,t,e)=>{e.d(t,{e:()=>c});var r=e(30565),o=e(28189),a=e(89359),s=e(13020),i=e(70929),u=e(12151),l=e(55537);const c=(0,i.op)({divNoNan_:function(n,t){let e=(0,o.YT)(n,"a","div"),i=(0,o.YT)(t,"b","div");[e,i]=(0,r.h0)(e,i);const c=(0,a.y)(e,i),p=(0,l.P)(c),h=(0,s.L)(i,p);return(0,u._)(h,p,c)}})},69759:(n,t,e)=>{e.d(t,{O:()=>u});var r=e(28189),o=e(45119),a=e(65703),s=e(70929),i=e(62302);const u=(0,s.op)({dot_:function(n,t){const e=(0,r.YT)(n,"t1","dot"),s=(0,r.YT)(t,"t2","dot");o.vA(!(1!==e.rank&&2!==e.rank||1!==s.rank&&2!==s.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${s.rank}.`));const u=1===e.rank?e.size:e.shape[1],l=1===s.rank?s.size:s.shape[0];if(o.vA(u===l,(()=>`Error in dot: inner dimensions of inputs must match, but got ${u} and ${l}.`)),1===e.rank&&1===s.rank){const n=(0,i.t)(e,[1,-1]),t=(0,i.t)(s,[-1,1]),r=(0,a.N)(n,t);return(0,i.t)(r,[])}if(1===e.rank&&2===s.rank){const n=(0,i.t)(e,[1,-1]),t=(0,i.t)(s,[s.shape[0],s.shape[1]]),r=(0,a.N)(n,t);return(0,i.t)(r,[r.size])}if(2===e.rank&&1===s.rank){const n=(0,i.t)(s,[-1,1]),t=(0,a.N)(e,n);return(0,i.t)(t,[t.size])}{const n=(0,i.t)(s,[s.shape[0],s.shape[1]]);return(0,a.N)(e,n)}}})},19457:(n,t,e)=>{e.d(t,{E:()=>h});var r=e(50259),o=e(28189),a=e(45119),s=e(37523),i=e(89359),u=e(15606),l=e(9258),c=e(70929),p=e(79546);const h=(0,c.op)({dropout_:function(n,t,e,c){const h=(0,o.YT)(n,"x","dropout");if(a.vA("float32"===h.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${h.dtype} tensor instead.`)),a.vA(t>=0&&t<1,(()=>`rate must be a float in the range [0, 1), but got ${t}.`)),0===t)return n instanceof r.qY?h.clone():h;const d=function(n,t){if(null==t)return n.shape.slice();if(a.r1(n.shape,t))return t;if(n.shape.length===t.length){const e=[];for(let r=0;r<n.shape.length;r++)null==t[r]&&null!=n.shape[r]?e.push(n.shape[r]):e.push(t[r]);return e}return t}(h,e),f=1-t,m=(0,i.y)((0,u.R)((0,s.W)((0,p.Y)(d,0,1,"float32",c),f)),f);return(0,l.l)(h,m)}})},79853:(n,t,e)=>{e.d(t,{_:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({einsum_:function(n,...t){const e=t.map(((n,t)=>(0,a.YT)(n,`tensors${t}`,"einsum"))),s={equation:n};return r.T2.runKernel(o.Qgm,e,s)}})},83416:(n,t,e)=>{e.d(t,{P:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({elu_:function(n){const t={x:(0,a.YT)(n,"x","elu","float32")};return r.T2.runKernel(o.Pah,t)}})},13020:(n,t,e)=>{e.d(t,{L:()=>u});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(62198);const u=(0,e(70929).op)({equal_:function(n,t){let e=(0,s.YT)(n,"a","equal","string_or_numeric"),u=(0,s.YT)(t,"b","equal","string_or_numeric");[e,u]=(0,a.h0)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const l={a:e,b:u};return r.T2.runKernel(o.BRl,l)}})},95207:(n,t,e)=>{e.d(t,{Y:()=>u});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(29809);const u=(0,e(70929).op)({erf_:function(n){let t=(0,a.YT)(n,"x","erf");s.vA("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=(0,i.w)(t,"float32"));const e={x:t};return r.T2.runKernel(o._s9,e)}})},11418:(n,t,e)=>{e.d(t,{HM:()=>r,T4:()=>o,_7:()=>a,fE:()=>u,fp:()=>s,mg:()=>i});const r=.3275911,o=.254829592,a=-.284496736,s=1.421413741,i=-1.453152027,u=1.061405429},44881:(n,t,e)=>{e.d(t,{p:()=>o});var r=e(92596);const o=(0,e(70929).op)({euclideanNorm_:function(n,t=null,e=!1){return(0,r.x)(n,"euclidean",t,e)}})},8631:(n,t,e)=>{e.d(t,{o:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({exp_:function(n){const t={x:(0,a.YT)(n,"x","exp")};return r.T2.runKernel(o.ox3,t)}})},8710:(n,t,e)=>{e.d(t,{U:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({expandDims_:function(n,t=0){const e=(0,a.YT)(n,"x","expandDims","string_or_numeric");s.vA(t<=e.rank,(()=>"Axis must be <= rank of the tensor"));const i={input:e},u={dim:t};return r.T2.runKernel(o.ybN,i,u)}})},40517:(n,t,e)=>{e.d(t,{I:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({expm1_:function(n){const t={x:(0,a.YT)(n,"x","expm1")};return r.T2.runKernel(o.ybj,t)}})},53621:(n,t,e)=>{e.d(t,{y:()=>u});var r=e(448),o=e(8710),a=e(70929),s=e(62302),i=e(64826);const u=(0,a.op)({eye_:function(n,t,e,a="float32"){null==t&&(t=n);const u=(0,r.r)([n,t],a),l=n<=t?n:t;for(let n=0;n<l;++n)u.set(1,n,n);const c=(0,s.t)(u.toTensor(),[n,t]);if(null==e)return c;if(1===e.length)return(0,i.V)((0,o.U)(c,0),[e[0],1,1]);if(2===e.length)return(0,i.V)((0,o.U)((0,o.U)(c,0),0),[e[0],e[1],1,1]);if(3===e.length)return(0,i.V)((0,o.U)((0,o.U)((0,o.U)(c,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}})},96111:(n,t,e)=>{e.d(t,{G:()=>s});var r=e(67897),o=e(15441),a=e(45119);function s(n,t,e){(0,a.SA)(n);const s={shape:n,value:t,dtype:e};return r.T2.runKernel(o.SQl,{},s)}},15606:(n,t,e)=>{e.d(t,{R:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({floor_:function(n){const t={x:(0,a.YT)(n,"x","floor","float32")};return r.T2.runKernel(o.ZgB,t)}})},88991:(n,t,e)=>{e.d(t,{w:()=>i});var r=e(67897),o=e(15441),a=e(30565),s=e(28189);const i=(0,e(70929).op)({floorDiv_:function(n,t){let e=(0,s.YT)(n,"a","floorDiv"),i=(0,s.YT)(t,"b","floorDiv");[e,i]=(0,a.h0)(e,i);const u={a:e,b:i};return r.T2.runKernel(o.ElG,u)}})},2956:(n,t,e)=>{e.r(t),e.d(t,{conv2d:()=>b,depthwiseConv2d:()=>E,matMul:()=>A});var r=e(67897),o=e(31830),a=e(15441),s=e(30565),i=e(28189),u=e(45119),l=e(37523),c=e(62198),p=e(28794),h=e(25248),d=e(80252),f=e(47195),m=e(68646),g=e(70929),v=e(62302);const b=(0,g.op)({fusedConv2d_:function({x:n,filter:t,strides:e,pad:g,dataFormat:b="NHWC",dilations:k=[1,1],dimRoundingMode:T,bias:x,activation:E="linear",preluActivationWeights:$,leakyreluAlpha:A}){if(E=E||"linear",!1===(0,m.zE)(r.T2.state.gradientDepth,E)){u.vA("NHWC"===b,(()=>`Error in fused conv2d: got dataFormat of ${b} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let r=(0,p.X)(n,t,e,g,b,k,T);return null!=x&&(r=(0,l.W)(r,x)),(0,m.f2)(r,E,$,A)}const y=(0,i.YT)(n,"x","conv2d","float32"),Y=(0,i.YT)(t,"filter","conv2d","float32");let _=y,w=!1;3===y.rank&&(w=!0,_=(0,v.t)(y,[1,y.shape[0],y.shape[1],y.shape[2]])),u.vA(4===_.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${_.rank}.`)),u.vA(4===Y.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${Y.rank}.`)),f.s_("fused conv2d",g,T);const N="NHWC"===b?_.shape[3]:_.shape[1];u.vA(Y.shape[2]===N,(()=>`Error in conv2d: depth of input (${N}) must match input depth for filter ${Y.shape[2]}.`)),u.vA(f.G0(e,k),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${k}'`));const S=f.uf(_.shape,Y.shape,e,k,g,T);let D,M;if(null!=x&&(D=(0,i.YT)(x,"bias","fused conv2d"),[D]=(0,s.h0)(D,y),"NHWC"===b?c.assertAndGetBroadcastShape(S.outShape,D.shape):(u.vA(D.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${D.shape.length}.`)),u.vA(0===D.shape.length||D.shape[0]===S.outChannels||1===D.shape[0],(()=>`Error in fused conv2d: bias shape (${D.shape}) is not compatible with the number of output channels (${S.outChannels})`)))),null!=$){const n=$.shape;if(u.vA(n.length<=1||3===n.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${n.length}.`)),1===n.length)u.vA(1===n[0]||n[0]===S.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${n}) is not compatible with the number of output channels (${S.outChannels}).`));else if(3===n.length)try{c.assertAndGetBroadcastShape(n,S.outShape)}catch(t){const e=`Error in fused conv2d: PReLU activation weights (${n}) is not compatible with the output shape of the conv2d (${S.outShape}).`;throw Error(e)}M=(0,i.YT)($,"prelu weights","fused conv2d")}const C=(n,t)=>{u.vA("NHWC"===b,(()=>`Error in gradient of fused conv2D: got dataFormat of ${b} but only NHWC is currently supported.`));const[r,o,a,s]=t,i=(0,m.XB)(n,a,E);u.vA(f.Dh(k),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${k}'`));const l=[(0,d.v)(o.shape,i,r,e,g),(0,h.H)(o,i,r.shape,e,g)];if(null!=s){const n=(0,m.Do)(s,i);l.push(n)}return l},K={x:_,filter:Y,bias:D,preluActivationWeights:M},W={strides:e,pad:g,dataFormat:b,dilations:k,dimRoundingMode:T,activation:E,leakyreluAlpha:A};if(null==x){const n=(0,o._X)(((n,t,e)=>{let o=r.T2.runKernel(a.aAr,K,W);return e([t,n,o]),w&&(o=(0,v.t)(o,[o.shape[1],o.shape[2],o.shape[3]])),{value:o,gradFunc:C}}));return n(_,Y)}{const n=(0,o._X)(((n,t,e,o)=>{let s=r.T2.runKernel(a.aAr,K,W);return o([t,n,s,e]),w&&(s=(0,v.t)(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:C}}));return n(_,Y,D)}}});var k=e(10676),T=e(41890),x=e(83134);const E=(0,g.op)({fusedDepthwiseConv2d_:function({x:n,filter:t,strides:e,pad:p,dataFormat:h="NHWC",dilations:d=[1,1],dimRoundingMode:g,bias:b,activation:E="linear",preluActivationWeights:$,leakyreluAlpha:A}){if(!1===(0,m.zE)(r.T2.state.gradientDepth,E)){let r=(0,k.G)(n,t,e,p,h,d,g);return null!=b&&(r=(0,l.W)(r,b)),(0,m.f2)(r,E,$,A)}const y=(0,i.YT)(n,"x","depthwiseConv2d","float32"),Y=(0,i.YT)(t,"filter","depthwiseConv2d","float32");let _=y,w=!1;3===y.rank&&(w=!0,_=(0,v.t)(y,[1,y.shape[0],y.shape[1],y.shape[2]])),u.vA(4===_.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${_.rank}.`)),u.vA(4===Y.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${Y.rank}.`)),u.vA(_.shape[3]===Y.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${_.shape[3]}) must match the inChannels dimension in filter ${Y.shape[2]}.`)),null==d&&(d=[1,1]),u.vA(f.G0(e,d),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${d}'`)),f.s_("fused depthwiseConv2d",p,g);const N=f.uf(_.shape,Y.shape,e,d,p,g,!0);let S,D;null!=b&&(S=(0,i.YT)(b,"bias","fused conv2d"),[S]=(0,s.h0)(S,y),c.assertAndGetBroadcastShape(N.outShape,S.shape)),null!=$&&(D=(0,i.YT)($,"prelu weights","fused depthwiseConv2d"));const M=(n,t)=>{u.vA(f.Dh(d),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${d}'`));const[r,o,a,s]=t,i=(0,m.XB)(n,a,E),l=(0,x.l)(o.shape,i,r,e,p,d,g),c=(0,T.x)(o,i,r.shape,e,p,d,g);return null!=s?[l,c,(0,m.Do)(S,i)]:[l,c]},C={x:_,filter:Y,bias:S,preluActivationWeights:D},K={strides:e,pad:p,dataFormat:h,dilations:d,dimRoundingMode:g,activation:E,leakyreluAlpha:A};if(null==b){const n=(0,o._X)(((n,t,e)=>{let o=r.T2.runKernel(a.T7M,C,K);return e([t,n,o]),w&&(o=(0,v.t)(o,[o.shape[1],o.shape[2],o.shape[3]])),{value:o,gradFunc:M}}));return n(_,Y)}{const n=(0,o._X)(((n,t,e,o)=>{let s=r.T2.runKernel(a.T7M,C,K);return o([t,n,s,e]),w&&(s=(0,v.t)(s,[s.shape[1],s.shape[2],s.shape[3]])),{value:s,gradFunc:M}}));return n(_,Y,S)}}});var $=e(65703);const A=(0,g.op)({fusedMatMul_:function({a:n,b:t,transposeA:e=!1,transposeB:p=!1,bias:h,activation:d="linear",preluActivationWeights:f,leakyreluAlpha:g=.2}){if(!1===(0,m.zE)(r.T2.state.gradientDepth,d)){let r=(0,$.N)(n,t,e,p);return null!=h&&(r=(0,l.W)(r,h)),(0,m.f2)(r,d,f,g)}let b=(0,i.YT)(n,"a","fused matMul"),k=(0,i.YT)(t,"b","fused matMul");[b,k]=(0,s.h0)(b,k);const T=e?b.shape[b.rank-2]:b.shape[b.rank-1],x=p?k.shape[k.rank-1]:k.shape[k.rank-2],E=e?b.shape[b.rank-1]:b.shape[b.rank-2],A=p?k.shape[k.rank-2]:k.shape[k.rank-1],y=b.shape.slice(0,-2),Y=k.shape.slice(0,-2),_=u.Ze(y),w=u.Ze(Y);u.vA(T===x,(()=>`Error in fused matMul: inner shapes (${T}) and (${x}) of Tensors with shapes ${b.shape} and ${k.shape} and transposeA=${e} and transposeB=${p} must match.`));const N=c.assertAndGetBroadcastShape(b.shape.slice(0,-2),k.shape.slice(0,-2)).concat([E,A]),S=e?(0,v.t)(b,[_,T,E]):(0,v.t)(b,[_,E,T]),D=p?(0,v.t)(k,[w,A,x]):(0,v.t)(k,[w,x,A]);let M,C;null!=h&&(M=(0,i.YT)(h,"bias","fused matMul"),[M]=(0,s.h0)(M,b),c.assertAndGetBroadcastShape(N,M.shape)),null!=f&&(C=(0,i.YT)(f,"prelu weights","fused matMul"));const K=(n,t)=>{const[r,o,a,s]=t,i=(0,m.XB)((0,v.t)(n,a.shape),a,d);let u,l;return e||p?!e&&p?(u=(0,$.N)(i,o,!1,!1),l=(0,$.N)(i,r,!0,!1)):e&&!p?(u=(0,$.N)(o,i,!1,!0),l=(0,$.N)(r,i,!1,!1)):(u=(0,$.N)(o,i,!0,!0),l=(0,$.N)(i,r,!0,!0)):(u=(0,$.N)(i,o,!1,!0),l=(0,$.N)(r,i,!0,!1)),null!=h?[u,l,(0,m.Do)(s,i)]:[u,l]},W={a:S,b:D,bias:M,preluActivationWeights:C},I={transposeA:e,transposeB:p,activation:d,leakyreluAlpha:g};if(null==h){const n=(0,o._X)(((n,t,e)=>{const o=r.T2.runKernel(a.Dr,W,I);return e([n,t,o]),{value:(0,v.t)(o,N),gradFunc:K}}));return n(S,D)}{const n=(0,o._X)(((n,t,e,o)=>{const s=r.T2.runKernel(a.Dr,W,I);return o([n,t,s,e]),{value:(0,v.t)(s,N),gradFunc:K}}));return n(S,D,M)}}})},68646:(n,t,e)=>{e.d(t,{Do:()=>m,XB:()=>f,f2:()=>g,zE:()=>v});var r=e(62198),o=e(83416),a=e(66919),s=e(9258),i=e(64394),u=e(90112),l=e(83732),c=e(62302),p=e(28968),h=e(10700),d=e(83791);function f(n,t,e){if(null==e||"linear"===e)return n;if("relu"===e)return(0,s.l)(n,(0,h.P)(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function m(n,t){let e=t;const o=r.getReductionAxes(n.shape,t.shape);return o.length>0&&(e=(0,d.c)(e,o)),(0,c.t)(e,n.shape)}function g(n,t,e,r){if("linear"===t)return n;if("relu"===t)return(0,u.V)(n);if("elu"===t)return(0,o.P)(n);if("relu6"===t)return(0,l.j)(n);if("prelu"===t)return(0,i.N)(n,e);if("leakyrelu"===t)return(0,a.H)(n,r);if("sigmoid"===t)return(0,p.r)(n);throw new Error(`Unknown fused activation ${t}.`)}const v=(n,t)=>!(n>0)||"linear"===t},48229:(n,t,e)=>{e.d(t,{k:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({gather_:function(n,t,e=0,s=0){const i={x:(0,a.YT)(n,"x","gather"),indices:(0,a.YT)(t,"indices","gather","int32")},u={axis:e,batchDims:s};return r.T2.runKernel(o.mxL,i,u)}})},55598:(n,t,e)=>{e.d(t,{S:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({gatherND_:function(n,t){const e=(0,a.YT)(t,"indices","gatherND","int32"),s={params:(0,a.YT)(n,"x","gatherND","string_or_numeric"),indices:e};return r.T2.runKernel(o.O4G,s)}})},83869:(n,t,e)=>{e.d(t,{N:()=>o});var r=e(45119);function o(n,t){const e=n.shape.length,o=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(o<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${o}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[o-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[o-1]} vs. ${e}`);if(0===(0,r.Ze)(n.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const a=t.shape,s=a[a.length-1];let i=1;for(let n=0;n<a.length-1;++n)i*=a[n];const u=n.shape,l=a.slice();l.pop();let c=1;for(let n=s;n<e;++n)c*=u[n],l.push(u[n]);const p=[...(0,r.Ur)(n.shape).map((n=>n/c)),1].slice(0,s);return[l,i,c,p]}},62058:(n,t,e)=>{e.d(t,{r:()=>u});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(62198);const u=(0,e(70929).op)({greater_:function(n,t){let e=(0,s.YT)(n,"a","greater","string_or_numeric"),u=(0,s.YT)(t,"b","greater","string_or_numeric");[e,u]=(0,a.h0)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const l={a:e,b:u};return r.T2.runKernel(o.XhZ,l)}})},13337:(n,t,e)=>{e.d(t,{D:()=>u});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(62198);const u=(0,e(70929).op)({greaterEqual_:function(n,t){let e=(0,s.YT)(n,"a","greaterEqual","string_or_numeric"),u=(0,s.YT)(t,"b","greaterEqual","string_or_numeric");[e,u]=(0,a.h0)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const l={a:e,b:u};return r.T2.runKernel(o.lLS,l)}})},35040:(n,t,e)=>{e.d(t,{n:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({imag_:function(n){const t={input:(0,a.YT)(n,"input","imag")};return r.T2.runKernel(o.dv8,t)}})},31951:(n,t,e)=>{e.d(t,{C:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({cropAndResize_:function(n,t,e,i,u="bilinear",l=0){const c=(0,a.YT)(n,"image","cropAndResize"),p=(0,a.YT)(t,"boxes","cropAndResize","float32"),h=(0,a.YT)(e,"boxInd","cropAndResize","int32"),d=p.shape[0];s.vA(4===c.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${c.rank}.`)),s.vA(2===p.rank&&4===p.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${d},4] but had shape ${p.shape}.`)),s.vA(1===h.rank&&h.shape[0]===d,(()=>`Error in cropAndResize: boxInd must be have size [${d}] but had shape ${p.shape}.`)),s.vA(2===i.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${i.length}.`)),s.vA(i[0]>=1&&i[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${i}`)),s.vA("bilinear"===u||"nearest"===u,(()=>`method must be bilinear or nearest, but was ${u}`));const f={image:c,boxes:p,boxInd:h},m={method:u,extrapolationValue:l,cropSize:i};return r.T2.runKernel(o.MRQ,f,m)}})},73866:(n,t,e)=>{e.d(t,{n:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({flipLeftRight_:function(n){const t=(0,a.YT)(n,"image","flipLeftRight","float32");s.vA(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const e={image:t};return r.T2.runKernel(o.BxF,e,{})}})},41477:(n,t,e)=>{e.d(t,{C:()=>i});var r=e(28189),o=e(45119),a=e(70929),s=e(64826);const i=(0,a.op)({grayscaleToRGB_:function(n){const t=(0,r.YT)(n,"image","grayscaleToRGB"),e=t.rank-1,a=t.shape[e];o.vA(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),o.vA(1===a,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${a}.`));const i=new Array(t.rank);return i.fill(1,0,e),i[e]=3,(0,s.V)(t,i)}})},56248:(n,t,e)=>{e.d(t,{L:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(68712);const i=(0,e(70929).op)({nonMaxSuppression_:function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY){const l=(0,a.YT)(n,"boxes","nonMaxSuppression","float32"),c=(0,a.YT)(t,"scores","nonMaxSuppression","float32"),p=(0,s.W)(l,c,e,i,u),h={maxOutputSize:e=p.maxOutputSize,iouThreshold:i=p.iouThreshold,scoreThreshold:u=p.scoreThreshold};return r.T2.runKernel(o.SDM,{boxes:l,scores:c},h)}})},70215:(n,t,e)=>{e.d(t,{z:()=>i});var r=e(8360),o=e(28189),a=e(68712),s=e(62018);const i=async function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY){const l=(0,o.YT)(n,"boxes","nonMaxSuppressionAsync"),c=(0,o.YT)(t,"scores","nonMaxSuppressionAsync"),p=(0,a.W)(l,c,e,i,u);e=p.maxOutputSize,i=p.iouThreshold,u=p.scoreThreshold;const h=await Promise.all([l.data(),c.data()]),d=h[0],f=h[1],{selectedIndices:m}=(0,r.c7)(d,f,e,i,u);return l!==n&&l.dispose(),c!==t&&c.dispose(),(0,s.t)(m,"int32")}},84305:(n,t,e)=>{e.d(t,{H:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(68712);const i=(0,e(70929).op)({nonMaxSuppressionPadded_:function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY,l=!1){const c=(0,a.YT)(n,"boxes","nonMaxSuppression"),p=(0,a.YT)(t,"scores","nonMaxSuppression"),h=(0,s.W)(c,p,e,i,u,null),d={boxes:c,scores:p},f={maxOutputSize:h.maxOutputSize,iouThreshold:h.iouThreshold,scoreThreshold:h.scoreThreshold,padToMaxOutputSize:l},m=r.T2.runKernel(o.Zl4,d,f);return{selectedIndices:m[0],validOutputs:m[1]}}})},5902:(n,t,e)=>{e.d(t,{R:()=>u});var r=e(8360),o=e(28189),a=e(68712),s=e(45702),i=e(62018);const u=async function(n,t,e,u=.5,l=Number.NEGATIVE_INFINITY,c=!1){const p=(0,o.YT)(n,"boxes","nonMaxSuppressionAsync"),h=(0,o.YT)(t,"scores","nonMaxSuppressionAsync"),d=(0,a.W)(p,h,e,u,l,null),f=d.maxOutputSize,m=d.iouThreshold,g=d.scoreThreshold,[v,b]=await Promise.all([p.data(),h.data()]),{selectedIndices:k,validOutputs:T}=(0,r.ZS)(v,b,f,m,g,c);return p!==n&&p.dispose(),h!==t&&h.dispose(),{selectedIndices:(0,i.t)(k,"int32"),validOutputs:(0,s.d)(T,"int32")}}},95634:(n,t,e)=>{e.d(t,{f:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(68712);const i=(0,e(70929).op)({nonMaxSuppressionWithScore_:function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY,l=0){const c=(0,a.YT)(n,"boxes","nonMaxSuppression"),p=(0,a.YT)(t,"scores","nonMaxSuppression"),h=(0,s.W)(c,p,e,i,u,l),d={boxes:c,scores:p},f={maxOutputSize:e=h.maxOutputSize,iouThreshold:i=h.iouThreshold,scoreThreshold:u=h.scoreThreshold,softNmsSigma:l=h.softNmsSigma},m=r.T2.runKernel(o.e0f,d,f);return{selectedIndices:m[0],selectedScores:m[1]}}})},7425:(n,t,e)=>{e.d(t,{l:()=>i});var r=e(8360),o=e(28189),a=e(68712),s=e(62018);const i=async function(n,t,e,i=.5,u=Number.NEGATIVE_INFINITY,l=0){const c=(0,o.YT)(n,"boxes","nonMaxSuppressionAsync"),p=(0,o.YT)(t,"scores","nonMaxSuppressionAsync"),h=(0,a.W)(c,p,e,i,u,l);e=h.maxOutputSize,i=h.iouThreshold,u=h.scoreThreshold,l=h.softNmsSigma;const d=await Promise.all([c.data(),p.data()]),f=d[0],m=d[1],{selectedIndices:g,selectedScores:v}=(0,r.ut)(f,m,e,i,u,l);return c!==n&&c.dispose(),p!==t&&p.dispose(),{selectedIndices:(0,s.t)(g,"int32"),selectedScores:(0,s.t)(v)}}},44711:(n,t,e)=>{e.d(t,{v:()=>l});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(70929),u=e(62302);const l=(0,i.op)({resizeBilinear_:function(n,t,e=!1,i=!1){const l=(0,a.YT)(n,"images","resizeBilinear");s.vA(3===l.rank||4===l.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${l.rank}.`)),s.vA(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),s.vA(!1===i||!1===e,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let c=l,p=!1;3===l.rank&&(p=!0,c=(0,u.t)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const[]=t,h={images:c},d={alignCorners:e,halfPixelCenters:i,size:t},f=r.T2.runKernel(o.hgw,h,d);return p?(0,u.t)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},42954:(n,t,e)=>{e.d(t,{b:()=>l});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(70929),u=e(62302);const l=(0,i.op)({resizeNearestNeighbor_:function(n,t,e=!1,i=!1){const l=(0,a.YT)(n,"images","resizeNearestNeighbor");s.vA(3===l.rank||4===l.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${l.rank}.`)),s.vA(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),s.vA("float32"===l.dtype||"int32"===l.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),s.vA(!1===i||!1===e,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let c=l,p=!1;3===l.rank&&(p=!0,c=(0,u.t)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));const[]=t,h={images:c},d={alignCorners:e,halfPixelCenters:i,size:t},f=r.T2.runKernel(o.jOE,h,d);return p?(0,u.t)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},64658:(n,t,e)=>{e.d(t,{x:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({rotateWithOffset_:function(n,t,e=0,i=.5){const u=(0,a.YT)(n,"image","rotateWithOffset","float32");s.vA(4===u.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${u.rank}.`));const l={image:u},c={radians:t,fillValue:e,center:i};return r.T2.runKernel(o.BK4,l,c)}})},80525:(n,t,e)=>{e.d(t,{E:()=>$});var r=e(62018),o=e(70929),a=e(29809),s=e(66512),i=e(40758),u=e(56508),l=e(62058),c=e(83791),p=e(37523),h=e(9258),d=e(89359),f=e(77126),m=e(25912),g=e(12151),v=e(96111),b=e(17986),k=e(44645),T=e(74027),x=e(45119),E=e(28189);const $=(0,o.op)({threshold_:function(n,t="binary",e=!1,o=.5){const $=(0,E.YT)(n,"image","threshold"),A=$.shape[0]*$.shape[1];let y,Y,_,w,N=(0,h.l)((0,r.t)([o]),255);if(x.vA(3===$.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${$.rank}.`)),x.vA(3===$.shape[2]||1===$.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${$.shape[2]}.`)),x.vA("int32"===$.dtype||"float32"===$.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${$.dtype}.`)),x.vA("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===$.shape[2]){[y,Y,_]=(0,s.l)($,[1,1,1],-1);const n=(0,h.l)(y,.2989),t=(0,h.l)(Y,.587),e=(0,h.l)(_,.114);w=(0,p.W)((0,p.W)(n,t),e)}else w=n;"otsu"===t&&(N=function(n,t){let e,o,a,s,i,u,m=(0,r.t)([-1]),T=(0,r.t)([0]),x=(0,r.t)([0]);for(let E=0;E<n.size-1;E++){e=(0,b.d)(n,0,E+1),o=(0,b.d)(n,E+1),i=(0,d.y)((0,c.c)(e),t),u=(0,d.y)((0,c.c)(o),t);const $=(0,c.c)((0,h.l)(e,(0,k.y)(0,e.size)));a=(0,d.y)($,(0,c.c)(e));const A=(0,v.G)(o.shape,e.size),y=(0,p.W)((0,k.y)(0,o.size),A),Y=(0,h.l)(o,y);s=(0,d.y)((0,c.c)(Y),(0,c.c)(o));const _=(0,f.j)(a,s),w=(0,f.j)(a,s),N=(0,h.l)(i,u);x=(0,h.l)((0,h.l)(N,_),w);const S=(0,l.r)(x,T);T=(0,g._)(S,x,T),m=(0,g._)(S,(0,r.t)([E]),m)}return m}((0,i.H)((0,a.w)((0,m.L)(w),"int32"),(0,T.O)([]),256),A));const S=e?(0,u.I)(w,N):(0,l.r)(w,N);return(0,a.w)((0,h.l)(S,255),"int32")}})},1242:(n,t,e)=>{e.d(t,{p:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({transform_:function(n,t,e="nearest",i="constant",u=0,l){const c=(0,a.YT)(n,"image","transform","float32"),p=(0,a.YT)(t,"transforms","transform","float32");s.vA(4===c.rank,(()=>`Error in transform: image must be rank 4,but got rank ${c.rank}.`)),s.vA(2===p.rank&&(p.shape[0]===c.shape[0]||1===p.shape[0])&&8===p.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),s.vA(null==l||2===l.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${l}.`));const h={image:c,transforms:p},d={interpolation:e,fillMode:i,fillValue:u,outputShape:l};return r.T2.runKernel(o.dLy,h,d)}})},5323:(n,t,e)=>{e.d(t,{U:()=>s});var r=e(28189),o=e(45119),a=e(74027);const s=async function(n,t,e=1){const s=(0,r.YT)(n,"predictions","inTopK"),i=(0,r.YT)(t,"targets","inTopK");(0,o.vA)(s.rank>1,(()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`)),(0,o.vA)(s.rank-1===i.rank,(()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${i.rank}`)),(0,o.O3)(s.shape.slice(0,s.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const u=s.shape[s.shape.length-1];(0,o.vA)(e>0&&e<=u,(()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${u}), but got ${e}`));const l=await s.data(),c=await i.data(),[p,h]=[l.length/u,u],d=(0,o.ce)("bool",p);for(let n=0;n<p;n++){const t=n*h,r=l.subarray(t,t+h),o=[];for(let n=0;n<r.length;n++)o.push({value:r[n],index:n});o.sort(((n,t)=>t.value-n.value)),d[n]=0;for(let t=0;t<e;t++)if(o[t].index===c[n]){d[n]=1;break}}return n!==s&&s.dispose(),t!==i&&i.dispose(),(0,a.O)(d,i.shape,"bool")}},68318:(n,t,e)=>{e.d(t,{M:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({isFinite_:function(n){const t={x:(0,a.YT)(n,"x","isFinite")};return r.T2.runKernel(o.gIW,t)}})},33454:(n,t,e)=>{e.d(t,{E:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({isInf_:function(n){const t={x:(0,a.YT)(n,"x","isInf")};return r.T2.runKernel(o.E3$,t)}})},6300:(n,t,e)=>{e.d(t,{y:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({isNaN_:function(n){const t={x:(0,a.YT)(n,"x","isNaN")};return r.T2.runKernel(o.iPs,t)}})},66919:(n,t,e)=>{e.d(t,{H:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({leakyRelu_:function(n,t=.2){const e={x:(0,a.YT)(n,"x","leakyRelu")},s={alpha:t};return r.T2.runKernel(o.X0$,e,s)}})},61303:(n,t,e)=>{e.d(t,{M:()=>u});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(62198);const u=(0,e(70929).op)({less_:function(n,t){let e=(0,s.YT)(n,"a","less","string_or_numeric"),u=(0,s.YT)(t,"b","less","string_or_numeric");[e,u]=(0,a.h0)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const l={a:e,b:u};return r.T2.runKernel(o.mIA,l)}})},56508:(n,t,e)=>{e.d(t,{I:()=>u});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(62198);const u=(0,e(70929).op)({lessEqual_:function(n,t){let e=(0,s.YT)(n,"a","lessEqual","string_or_numeric"),u=(0,s.YT)(t,"b","lessEqual","string_or_numeric");[e,u]=(0,a.h0)(e,u),(0,i.assertAndGetBroadcastShape)(e.shape,u.shape);const l={a:e,b:u};return r.T2.runKernel(o.CwD,l)}})},36359:(n,t,e)=>{e.d(t,{x:()=>v});var r=e(28189),o=e(45119),a=e(13337),s=e(56508),i=e(13789),u=e(70929),l=e(44645),c=e(62302),p=e(45702),h=e(54268),d=e(77126),f=e(67261),m=e(12151),g=e(42855);const v=(0,u.op)({bandPart_:function(n,t,e){(0,o.vA)(t%1==0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),(0,o.vA)(e%1==0,(()=>`bandPart(): numUpper must be an integer, got ${e}.`));const u=(0,r.YT)(n,"a","bandPart");(0,o.vA)(u.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${u.rank}.`));const v=u.shape,[b,k]=u.shape.slice(-2);if(!(t<=b))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${b}).`);if(!(e<=k))throw new Error(`bandPart(): numUpper (${e}) must not be greater than the number of columns (${k}).`);t<0&&(t=b),e<0&&(e=k);const T=(0,c.t)((0,l.y)(0,b,1,"int32"),[-1,1]),x=(0,l.y)(0,k,1,"int32"),E=(0,d.j)(T,x),$=(0,i.n)((0,s.I)(E,(0,p.d)(+t,"int32")),(0,a.D)(E,(0,p.d)(-e,"int32"))),A=(0,g.U)([b,k],u.dtype);return(0,c.t)((0,h.t)((0,f.K)((0,c.t)(u,[-1,b,k])).map((n=>(0,m._)($,n,A)))),v)}})},76304:(n,t,e)=>{e.d(t,{i:()=>f});var r=e(67897),o=e(45119),a=e(89359),s=e(9258),i=e(92596),u=e(70929),l=e(66512),c=e(5932),p=e(54268),h=e(77126),d=e(83791);const f=(0,u.op)({gramSchmidt_:function(n){let t;if(Array.isArray(n)){t=!1,(0,o.vA)(null!=n&&n.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const e=n[0].shape[0];for(let t=1;t<n.length;++t)(0,o.vA)(n[t].shape[0]===e,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[t].shape[0]} vs. ${e})`))}else t=!0,n=(0,l.l)(n,n.shape[0],0).map((n=>(0,c.r)(n,[0])));(0,o.vA)(n.length<=n[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`));const e=[],u=n;for(let t=0;t<n.length;++t)e.push(r.T2.tidy((()=>{let n=u[t];if(t>0)for(let r=0;r<t;++r){const t=(0,s.l)((0,d.c)((0,s.l)(e[r],n)),e[r]);n=(0,h.j)(n,t)}return(0,a.y)(n,(0,i.x)(n,"euclidean"))})));return t?(0,p.t)(e,0):e}})},1211:(n,t,e)=>{e.d(t,{qr:()=>y});var r=e(67897),o=e(35287),a=e(45119),s=e(70125),i=e(25030),u=e(89359),l=e(53621),c=e(62058),p=e(65703),h=e(9258),d=e(96522),f=e(92596),m=e(70929),g=e(62302),v=e(17986),b=e(54268),k=e(77126),T=e(18941),x=e(7703),E=e(67261),$=e(12151);function A(n,t=!1){return r.T2.tidy((()=>{(0,a.vA)(2===n.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`));const e=n.shape[0],m=n.shape[1];let g=(0,l.y)(e),b=(0,s.o)(n);const E=(0,T.K)([[1]],[1,1]);let A=(0,s.o)(E);const y=e>=m?m:e;for(let n=0;n<y;++n){const t=b,a=A,l=g;[A,b,g]=r.T2.tidy((()=>{const t=(0,v.d)(b,[n,n],[e-n,1]),r=(0,f.x)(t),o=(0,v.d)(b,[n,n],[1,1]),a=(0,$._)((0,c.r)(o,0),(0,T.K)([[-1]]),(0,T.K)([[1]])),l=(0,k.j)(o,(0,h.l)(a,r)),y=(0,u.y)(t,l);A=1===y.shape[0]?(0,s.o)(E):(0,i.x)([E,(0,v.d)(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const Y=(0,d.H)((0,u.y)((0,p.N)(a,l),r)),_=(0,v.d)(b,[n,0],[e-n,m]),w=(0,h.l)(Y,A),N=(0,x.m)(A);if(0===n)b=(0,k.j)(_,(0,p.N)(w,(0,p.N)(N,_)));else{const t=(0,k.j)(_,(0,p.N)(w,(0,p.N)(N,_)));b=(0,i.x)([(0,v.d)(b,[0,0],[n,m]),t],0)}const S=(0,x.m)(w),D=(0,v.d)(g,[0,n],[e,g.shape[1]-n]);if(0===n)g=(0,k.j)(D,(0,p.N)((0,p.N)(D,A),S));else{const t=(0,k.j)(D,(0,p.N)((0,p.N)(D,A),S));g=(0,i.x)([(0,v.d)(g,[0,0],[e,n]),t],1)}return[A,b,g]})),(0,o.AS)([t,a,l])}return!t&&e>m&&(g=(0,v.d)(g,[0,0],[e,m]),b=(0,v.d)(b,[0,0],[m,m])),[g,b]}))}const y=(0,m.op)({qr_:function(n,t=!1){if((0,a.vA)(n.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`)),2===n.rank)return A(n,t);{const e=n.shape.slice(0,n.shape.length-2).reduce(((n,t)=>n*t)),r=(0,E.K)((0,g.t)(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),o=[],a=[];return r.forEach((n=>{const[e,r]=A(n,t);o.push(e),a.push(r)})),[(0,g.t)((0,b.t)(o,0),n.shape),(0,g.t)((0,b.t)(a,0),n.shape)]}}})},46545:(n,t,e)=>{e.d(t,{m:()=>a});var r=e(67897),o=e(15441);function a(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");const a={start:n,stop:t,num:e};return r.T2.runKernel(o.mnI,{},a)}},93531:(n,t,e)=>{e.d(t,{K:()=>l});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(70929),u=e(62302);const l=(0,i.op)({localResponseNormalization_:function(n,t=5,e=1,i=1,l=.5){const c=(0,a.YT)(n,"x","localResponseNormalization");s.vA(4===c.rank||3===c.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${c.rank}.`)),s.vA(s.E6(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let p=c,h=!1;3===c.rank&&(h=!0,p=(0,u.t)(c,[1,c.shape[0],c.shape[1],c.shape[2]]));const d={x:p},f={depthRadius:t,bias:e,alpha:i,beta:l},m=r.T2.runKernel(o.jM4,d,f);return h?(0,u.t)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},71892:(n,t,e)=>{e.d(t,{u:()=>a});var r=e(67897),o=e(15441);const a=(0,e(70929).op)({localResponseNormalizationBackprop_:function(n,t,e,a=5,s=1,i=1,u=.5){const l={x:n,y:t,dy:e},c={depthRadius:a,bias:s,alpha:i,beta:u};return r.T2.runKernel(o.ToN,l,c)}})},44010:(n,t,e)=>{e.d(t,{R:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({log_:function(n){const t={x:(0,a.YT)(n,"x","log","float32")};return r.T2.runKernel(o.tG8,t)}})},12015:(n,t,e)=>{e.d(t,{K:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({log1p_:function(n){const t={x:(0,a.YT)(n,"x","log1p")};return r.T2.runKernel(o.Cg$,t)}})},95645:(n,t,e)=>{e.d(t,{n:()=>c});var r=e(31830),o=e(28189),a=e(9258),s=e(96522),i=e(70929),u=e(28968),l=e(66030);const c=(0,i.op)({logSigmoid_:function(n){const t=(0,o.YT)(n,"x","logSigmoid");return(0,r._X)((n=>({value:(0,s.H)((0,l.l)((0,s.H)(n))),gradFunc:t=>(0,a.l)(t,(0,u.r)((0,s.H)(n)))})))(t)}})},97991:(n,t,e)=>{e.d(t,{H:()=>d});var r=e(31830),o=e(28189),a=e(29809),s=e(8631),i=e(44010),u=e(41938),l=e(9258),c=e(70929),p=e(77126),h=e(83791);const d=(0,c.op)({logSoftmax_:function(n,t=-1){const e=(0,o.YT)(n,"logits","logSoftmax");if(-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return(0,r._X)(((n,e)=>{const r=(0,u.T)(n,t,!0),o=(0,p.j)(n,r),c=(0,p.j)((0,a.w)(o,"float32"),(0,i.R)((0,h.c)((0,s.o)(o),t,!0)));return e([c]),{value:c,gradFunc:(n,e)=>{const[r]=e,o=(0,s.o)(r);return(0,p.j)(n,(0,l.l)((0,h.c)(n,t,!0),o))}}}))(e)}})},13330:(n,t,e)=>{e.d(t,{V:()=>f});var r=e(28189),o=e(45119),a=e(37523),s=e(21078),i=e(8631),u=e(44010),l=e(41938),c=e(70929),p=e(62302),h=e(77126),d=e(83791);const f=(0,c.op)({logSumExp_:function(n,t=null,e=!1){const c=(0,r.YT)(n,"x","logSumExp"),f=(0,o.Y6)(t,c.shape),m=(0,l.T)(c,f,!0),g=(0,h.j)(c,m),v=(0,i.o)(g),b=(0,d.c)(v,f),k=(0,u.R)(b),T=(0,a.W)((0,p.t)(m,k.shape),k);if(e){const n=(0,s.SM)(T.shape,f);return(0,p.t)(T,n)}return T}})},13789:(n,t,e)=>{e.d(t,{n:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(62198);const i=(0,e(70929).op)({logicalAnd_:function(n,t){const e=(0,a.YT)(n,"a","logicalAnd","bool"),i=(0,a.YT)(t,"b","logicalAnd","bool");(0,s.assertAndGetBroadcastShape)(e.shape,i.shape);const u={a:e,b:i};return r.T2.runKernel(o.RUm,u)}})},89881:(n,t,e)=>{e.d(t,{N:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({logicalNot_:function(n){const t={x:(0,a.YT)(n,"x","logicalNot","bool")};return r.T2.runKernel(o.nZd,t)}})},9879:(n,t,e)=>{e.d(t,{z:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(62198);const i=(0,e(70929).op)({logicalOr_:function(n,t){const e=(0,a.YT)(n,"a","logicalOr","bool"),i=(0,a.YT)(t,"b","logicalOr","bool");(0,s.assertAndGetBroadcastShape)(e.shape,i.shape);const u={a:e,b:i};return r.T2.runKernel(o.LXA,u)}})},19925:(n,t,e)=>{e.d(t,{r:()=>u});var r=e(28189),o=e(62198),a=e(13789),s=e(89881),i=e(9879);const u=(0,e(70929).op)({logicalXor_:function(n,t){const e=(0,r.YT)(n,"a","logicalXor","bool"),u=(0,r.YT)(t,"b","logicalXor","bool");return(0,o.assertAndGetBroadcastShape)(e.shape,u.shape),(0,a.n)((0,i.z)(n,t),(0,s.N)((0,a.n)(n,t)))}})},27084:(n,t,e)=>{var r;e.d(t,{i:()=>r}),function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},89535:(n,t,e)=>{e.d(t,{n:()=>c});var r=e(28189),o=e(45119),a=e(4888),s=e(27084),i=e(70929),u=e(77126),l=e(69533);const c=(0,i.op)({absoluteDifference_:function(n,t,e,i=s.i.SUM_BY_NONZERO_WEIGHTS){const c=(0,r.YT)(n,"labels","absoluteDifference"),p=(0,r.YT)(t,"predictions","absoluteDifference");let h=null;null!=e&&(h=(0,r.YT)(e,"weights","absoluteDifference")),(0,o.O3)(c.shape,p.shape,"Error in absoluteDifference: ");const d=(0,a.t)((0,u.j)(c,p));return(0,l.M)(d,h,i)}})},69533:(n,t,e)=>{e.d(t,{M:()=>f});var r=e(28189),o=e(29809),a=e(89359),s=e(27084),i=e(12611),u=e(9258),l=e(42118),c=e(61411),p=e(70929),h=e(45702),d=e(83791);const f=(0,p.op)({computeWeightedLoss_:function(n,t,e=s.i.SUM_BY_NONZERO_WEIGHTS){const p=(0,r.YT)(n,"losses","computeWeightedLoss");let f=null;null!=t&&(f=(0,r.YT)(t,"weights","computeWeightedLoss"));const m=null==f?p:(0,u.l)(p,f);if(e===s.i.NONE)return m;if(e===s.i.SUM)return(0,d.c)(m);if(e===s.i.MEAN){if(null==f)return(0,i.i)(m);{const n=p.size/f.size,t=(0,a.y)((0,d.c)(m),(0,d.c)(f));return n>1?(0,a.y)(t,(0,h.d)(n)):t}}if(e===s.i.SUM_BY_NONZERO_WEIGHTS){if(null==f)return(0,a.y)((0,d.c)(m),(0,h.d)(p.size));{const n=(0,u.l)(f,(0,c.S)(p.shape)),t=(0,o.w)((0,d.c)((0,l.E)(n,(0,h.d)(0))),"float32");return(0,a.y)((0,d.c)(m),t)}}throw Error(`Unknown reduction: ${e}`)}})},39417:(n,t,e)=>{e.d(t,{l:()=>h});var r=e(28189),o=e(45119),a=e(27084),s=e(9258),i=e(70929),u=e(45702),l=e(77126),c=e(83791),p=e(69533);const h=(0,i.op)({cosineDistance_:function(n,t,e,i,h=a.i.SUM_BY_NONZERO_WEIGHTS){const d=(0,r.YT)(n,"labels","cosineDistance"),f=(0,r.YT)(t,"predictions","cosineDistance");let m=null;null!=i&&(m=(0,r.YT)(i,"weights","cosineDistance")),(0,o.O3)(d.shape,f.shape,"Error in cosineDistance: ");const g=(0,u.d)(1),v=(0,l.j)(g,(0,c.c)((0,s.l)(d,f),e,!0));return(0,p.M)(v,m,h)}})},70327:(n,t,e)=>{e.d(t,{Z:()=>h});var r=e(28189),o=e(45119),a=e(27084),s=e(9258),i=e(70929),u=e(90112),l=e(45702),c=e(77126),p=e(69533);const h=(0,i.op)({hingeLoss_:function(n,t,e,i=a.i.SUM_BY_NONZERO_WEIGHTS){let h=(0,r.YT)(n,"labels","hingeLoss");const d=(0,r.YT)(t,"predictions","hingeLoss");let f=null;null!=e&&(f=(0,r.YT)(e,"weights","hingeLoss")),(0,o.O3)(h.shape,d.shape,"Error in hingeLoss: ");const m=(0,l.d)(1);h=(0,c.j)((0,s.l)((0,l.d)(2),h),m);const g=(0,u.V)((0,c.j)(m,(0,s.l)(h,d)));return(0,p.M)(g,f,i)}})},40718:(n,t,e)=>{e.d(t,{c:()=>m});var r=e(28189),o=e(45119),a=e(4888),s=e(37523),i=e(27084),u=e(12644),l=e(9258),c=e(70929),p=e(45702),h=e(45793),d=e(77126),f=e(69533);const m=(0,c.op)({huberLoss_:function(n,t,e,c=1,m=i.i.SUM_BY_NONZERO_WEIGHTS){const g=(0,r.YT)(n,"labels","huberLoss"),v=(0,r.YT)(t,"predictions","huberLoss");let b=null;null!=e&&(b=(0,r.YT)(e,"weights","huberLoss")),(0,o.O3)(g.shape,v.shape,"Error in huberLoss: ");const k=(0,p.d)(c),T=(0,a.t)((0,d.j)(v,g)),x=(0,u.B)(T,k),E=(0,d.j)(T,x),$=(0,s.W)((0,l.l)((0,p.d)(.5),(0,h.E)(x)),(0,l.l)(k,E));return(0,f.M)($,b,m)}})},21780:(n,t,e)=>{e.d(t,{_:()=>f});var r=e(28189),o=e(45119),a=e(37523),s=e(44010),i=e(27084),u=e(9258),l=e(96522),c=e(70929),p=e(45702),h=e(77126),d=e(69533);const f=(0,c.op)({logLoss_:function(n,t,e,c=1e-7,f=i.i.SUM_BY_NONZERO_WEIGHTS){const m=(0,r.YT)(n,"labels","logLoss"),g=(0,r.YT)(t,"predictions","logLoss");let v=null;null!=e&&(v=(0,r.YT)(e,"weights","logLoss")),(0,o.O3)(m.shape,g.shape,"Error in logLoss: ");const b=(0,p.d)(1),k=(0,p.d)(c),T=(0,l.H)((0,u.l)(m,(0,s.R)((0,a.W)(g,k)))),x=(0,u.l)((0,h.j)(b,m),(0,s.R)((0,a.W)((0,h.j)(b,g),k))),E=(0,h.j)(T,x);return(0,d.M)(E,v,f)}})},22150:(n,t,e)=>{e.d(t,{b:()=>l});var r=e(28189),o=e(45119),a=e(27084),s=e(70929),i=e(53427),u=e(69533);const l=(0,s.op)({meanSquaredError_:function(n,t,e,s=a.i.SUM_BY_NONZERO_WEIGHTS){const l=(0,r.YT)(n,"labels","meanSquaredError"),c=(0,r.YT)(t,"predictions","meanSquaredError");let p=null;null!=e&&(p=(0,r.YT)(e,"weights","meanSquaredError")),(0,o.O3)(l.shape,c.shape,"Error in meanSquaredError: ");const h=(0,i.P)(l,c);return(0,u.M)(h,p,s)}})},58687:(n,t,e)=>{e.d(t,{k:()=>v});var r=e(28189),o=e(45119),a=e(4888),s=e(37523),i=e(8631),u=e(12015),l=e(27084),c=e(9258),p=e(96522),h=e(70929),d=e(90112),f=e(45702),m=e(77126),g=e(69533);const v=(0,h.op)({sigmoidCrossEntropy_:function(n,t,e,h=0,v=l.i.SUM_BY_NONZERO_WEIGHTS){let b=(0,r.YT)(n,"multiClassLabels","sigmoidCrossEntropy");const k=(0,r.YT)(t,"logits","sigmoidCrossEntropy");let T=null;if(null!=e&&(T=(0,r.YT)(e,"weights","sigmoidCrossEntropy")),(0,o.O3)(b.shape,k.shape,"Error in sigmoidCrossEntropy: "),h>0){const n=(0,f.d)(h),t=(0,f.d)(1),e=(0,f.d)(.5);b=(0,s.W)((0,c.l)(b,(0,m.j)(t,n)),(0,c.l)(e,n))}const x=function(n,t){const e=(0,r.YT)(n,"labels","sigmoidCrossEntropyWithLogits"),l=(0,r.YT)(t,"logits","sigmoidCrossEntropyWithLogits");(0,o.O3)(e.shape,l.shape,"Error in sigmoidCrossEntropyWithLogits: ");const h=(0,d.V)(l),f=(0,c.l)(l,e),g=(0,u.K)((0,i.o)((0,p.H)((0,a.t)(l))));return(0,s.W)((0,m.j)(h,f),g)}(b,k);return(0,g.M)(x,T,v)}})},69881:(n,t,e)=>{e.d(t,{C:()=>x});var r=e(31830),o=e(28189),a=e(45119),s=e(37523),i=e(21078),u=e(29809),l=e(89359),c=e(8631),p=e(13330),h=e(27084),d=e(9258),f=e(96522),m=e(70929),g=e(62302),v=e(45702),b=e(77126),k=e(83791),T=e(69533);const x=(0,m.op)({softmaxCrossEntropy_:function(n,t,e,m=0,x=h.i.SUM_BY_NONZERO_WEIGHTS){let E=(0,o.YT)(n,"onehotLabels","softmaxCrossEntropy");const $=(0,o.YT)(t,"logits","softmaxCrossEntropy");let A=null;if(null!=e&&(A=(0,o.YT)(e,"weights","softmaxCrossEntropy")),(0,a.O3)(E.shape,$.shape,"Error in softmaxCrossEntropy: "),m>0){const n=(0,v.d)(m),t=(0,v.d)(1),e=(0,v.d)(E.shape[1]);E=(0,s.W)((0,d.l)(E,(0,b.j)(t,n)),(0,l.y)(n,e))}const y=function(n,t,e=-1){if(-1===e&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${e}`);const o=(0,r._X)(((n,t,r)=>{const o=(0,p.V)(t,[e],!0),a=(0,b.j)((0,u.w)(t,"float32"),o);r([n,a]);const s=(0,f.H)((0,d.l)(a,n));return{value:(0,k.c)(s,[e]),gradFunc:(n,t)=>{const[r,o]=t,a=(0,i.SM)(n.shape,[e]);return[(0,d.l)((0,g.t)(n,a),(0,b.j)((0,u.w)(r,"float32"),(0,c.o)(o))),(0,d.l)((0,g.t)(n,a),(0,b.j)((0,c.o)(o),(0,u.w)(r,"float32")))]}}}));return o(n,t)}(E,$);return(0,T.M)(y,A,x)}})},80462:(n,t,e)=>{e.d(t,{y:()=>o});var r=e(79120);function o(n,t){return(0,r.s)(n,t,"left")}},65703:(n,t,e)=>{e.d(t,{N:()=>i});var r=e(67897),o=e(15441),a=e(30565),s=e(28189);const i=(0,e(70929).op)({matMul_:function(n,t,e=!1,i=!1){let u=(0,s.YT)(n,"a","matMul"),l=(0,s.YT)(t,"b","matMul");[u,l]=(0,a.h0)(u,l);const c={a:u,b:l},p={transposeA:e,transposeB:i};return r.T2.runKernel(o.jAQ,c,p)}})},41938:(n,t,e)=>{e.d(t,{T:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({max_:function(n,t=null,e=!1){const s={x:(0,a.YT)(n,"x","max")},i={reductionIndices:t,keepDims:e};return r.T2.runKernel(o.VAI,s,i)}})},86999:(n,t,e)=>{e.d(t,{j:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195),u=e(70929),l=e(62302);const c=(0,u.op)({maxPool_:function(n,t,e,u,c){const p=(0,a.YT)(n,"x","maxPool");let h=p,d=!1;3===p.rank&&(d=!0,h=(0,l.t)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),s.vA(4===h.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${h.rank}.`)),s.vA(i.G0(e,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '1'`)),i.s_("maxPool",u,c);const f={x:h},m={filterSize:t,strides:e,pad:u,dimRoundingMode:c},g=r.T2.runKernel(o.t3d,f,m);return d?(0,l.t)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},14349:(n,t,e)=>{e.d(t,{e:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195),u=e(70929),l=e(62302);const c=(0,u.op)({maxPool3d_:function(n,t=[1,1,1],e,u,c,p="NDHWC"){const h=(0,a.YT)(n,"x","maxPool3d");let d=h,f=!1;4===h.rank&&(f=!0,d=(0,l.t)(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),s.vA(5===d.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${d.rank}.`)),s.vA("NDHWC"===p,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${p}`)),(0,i.s_)("maxPool3d",u,c);const m={x:d},g={filterSize:t,strides:e,pad:u,dimRoundingMode:c,dataFormat:p},v=r.T2.runKernel(o.ySp,m,g);return f?(0,l.t)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}})},28304:(n,t,e)=>{e.d(t,{s:()=>c});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195),u=e(70929),l=e(62302);const c=(0,u.op)({maxPool3dGrad_:function(n,t,e,u,c,p,h){const d=(0,a.YT)(n,"dy","maxPool3dGrad"),f=(0,a.YT)(t,"input","maxPool3dGrad"),m=(0,a.YT)(e,"output","maxPool3dGrad");let g=d,v=f,b=m,k=!1;4===f.rank&&(k=!0,g=(0,l.t)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]]),v=(0,l.t)(f,[1,f.shape[0],f.shape[1],f.shape[2],f.shape[3]]),b=(0,l.t)(m,[1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]])),s.vA(5===g.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${g.rank}.`)),s.vA(5===v.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${v.rank}.`)),s.vA(5===b.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${b.rank}.`)),(0,i.s_)("maxPool3dGrad",p,h);const T={dy:g,input:v,output:b},x={filterSize:u,strides:c,pad:p,dimRoundingMode:h},E=r.T2.runKernel(o.cHb,T,x);return k?(0,l.t)(E,[E.shape[1],E.shape[2],E.shape[3],E.shape[4]]):E}})},23938:(n,t,e)=>{e.d(t,{d:()=>u});var r=e(67897),o=e(15441),a=e(28189),s=e(45119),i=e(47195);const u=(0,e(70929).op)({maxPoolGrad_:function(n,t,e,u,l,c,p){const h=(0,a.YT)(n,"dy","maxPoolGrad"),d=(0,a.YT)(t,"input","maxPoolGrad"),f=(0,a.YT)(e,"output","maxPoolGrad");s.vA(d.rank===h.rank,(()=>`Rank of input (${d.rank}) does not match rank of dy (${h.rank})`)),s.vA(4===h.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${h.rank}.`)),s.vA(4===d.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${d.rank}.`)),i.s_("maxPoolGrad",c,p);const m={dy:h,input:d,output:f},g={filterSize:u,strides:l,pad:c,dimRoundingMode:p};return r.T2.runKernel(o.RXX,m,g)}})},45243:(n,t,e)=>{e.d(t,{R:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({maxPoolWithArgmax_:function(n,t,e,s,i=!1){const u={x:(0,a.YT)(n,"x","maxPoolWithArgmax")},l={filterSize:t,strides:e,pad:s,includeBatchInIndex:i},c=r.T2.runKernel(o.TL8,u,l);return{result:c[0],indexes:c[1]}}})},30178:(n,t,e)=>{e.d(t,{P:()=>l});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(62198),u=e(29809);const l=(0,e(70929).op)({maximum_:function(n,t){let e=(0,s.YT)(n,"a","maximum"),l=(0,s.YT)(t,"b","maximum");[e,l]=(0,a.h0)(e,l),"bool"===e.dtype&&(e=(0,u.w)(e,"int32"),l=(0,u.w)(l,"int32")),(0,i.assertAndGetBroadcastShape)(e.shape,l.shape);const c={a:e,b:l};return r.T2.runKernel(o.LDN,c)}})},12611:(n,t,e)=>{e.d(t,{i:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({mean_:function(n,t=null,e=!1){const s={x:(0,a.YT)(n,"x","mean")},i={axis:t,keepDims:e};return r.T2.runKernel(o.g5A,s,i)}})},15027:(n,t,e)=>{e.d(t,{O:()=>l});var r=e(65703),o=e(61411),a=e(62302),s=e(50259),i=e(28189),u=e(45119);function l(n,t,{indexing:e="xy"}={}){if("xy"!==e&&"ij"!==e)throw new TypeError(`${e} is not a valid third argument to meshgrid`);if(void 0===n)return[];let l=(0,i.YT)(n,"x","meshgrid",n instanceof s.qY?n.dtype:"float32");if(void 0===t)return[l];let c=(0,i.YT)(t,"y","meshgrid",t instanceof s.qY?t.dtype:"float32");const p=(0,u.Ze)(l.shape),h=(0,u.Ze)(c.shape);return"xy"===e?(l=(0,a.t)(l,[1,-1]),c=(0,a.t)(c,[-1,1]),[(0,r.N)((0,o.S)([h,1],l.dtype),l),(0,r.N)(c,(0,o.S)([1,p],c.dtype))]):(l=(0,a.t)(l,[-1,1]),c=(0,a.t)(c,[1,-1]),[(0,r.N)(l,(0,o.S)([1,h],l.dtype)),(0,r.N)((0,o.S)([p,1],c.dtype),c)])}},57436:(n,t,e)=>{e.d(t,{j:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({min_:function(n,t=null,e=!1){const s={x:(0,a.YT)(n,"x","min")},i={axis:t,keepDims:e};return r.T2.runKernel(o.lNG,s,i)}})},12644:(n,t,e)=>{e.d(t,{B:()=>l});var r=e(67897),o=e(15441),a=e(30565),s=e(28189),i=e(62198),u=e(29809);const l=(0,e(70929).op)({minimum_:function(n,t){let e=(0,s.YT)(n,"a","minimum"),l=(0,s.YT)(t,"b","minimum");[e,l]=(0,a.h0)(e,l),"bool"===e.dtype&&(e=(0,u.w)(e,"int32"),l=(0,u.w)(l,"int32")),(0,i.assertAndGetBroadcastShape)(e.shape,l.shape);const c={a:e,b:l};return r.T2.runKernel(o.LG0,c)}})},66567:(n,t,e)=>{e.d(t,{F:()=>i});var r=e(67897),o=e(15441),a=e(28189),s=e(45119);const i=(0,e(70929).op)({mirrorPad_:function(n,t,e){s.vA("reflect"===e||"symmetric"===e,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`));const i=(0,a.YT)(n,"x","mirrorPad");if(0===i.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");s.vA(t.length===i.rank,(()=>`Padding doesn't match input. Must be ${i.rank}. Got ${t.length}.`));const u="reflect"===e?1:0;for(let n=0;n<i.rank;n++)s.vA(2===t[n].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),s.vA(t[n][0]>=0&&t[n][0]<=i.shape[n]-u&&t[n][1]>=0&&t[n][1]<=i.shape[n]-u,(()=>`Padding in dimension ${n} cannot be greater than or equal to ${i.shape[n]-u} or less than 0 for input of shape ${i.shape}`));const l={paddings:t,mode:e},c={x:i};return r.T2.runKernel(o.x7F,c,l)}})},60152:(n,t,e)=>{e.d(t,{z:()=>i});var r=e(67897),o=e(15441),a=e(30565),s=e(28189);const i=(0,e(70929).op)({mod_:function(n,t){let e=(0,s.YT)(n,"a","mod"),i=(0,s.YT)(t,"b","mod");[e,i]=(0,a.h0)(e,i);const u={a:e,b:i};return r.T2.runKernel(o.BLA,u)}})},91413:(n,t,e)=>{e.d(t,{C:()=>h});var r=e(28189),o=e(45119),a=e(21078),s=e(29809),i=e(12611),u=e(70929),l=e(62302),c=e(45793),p=e(77126);const h=(0,u.op)({moments_:function(n,t=null,e=!1){n=(0,r.YT)(n,"x","moments");const u=(0,o.Y6)(t,n.shape),h=(0,i.i)(n,u,e);let d=h.shape;e||(d=(0,a.SM)(h.shape,u));const f=(0,c.E)((0,p.j)((0,s.w)(n,"float32"),(0,l.t)(h,d)));return{mean:h,variance:(0,i.i)(f,u,e)}}})},65772:(n,t,e)=>{e.d(t,{C:()=>d});var r=e(30565),o=e(28189),a=e(45119),s=e(37523),i=e(89359),u=e(9258),l=e(70929),c=e(98990),p=e(45702),h=e(77126);const d=(0,l.op)({movingAverage_:function(n,t,e,l,d=!0){const f=(0,o.YT)(n,"v","movingAverage"),m=(0,o.YT)(t,"x","movingAverage"),g=(0,o.YT)(e,"decay","movingAverage");(0,r.rt)(f,m),a.vA(a.r1(f.shape,m.shape),(()=>"Shape mismatch in v and x"));const v=(0,p.d)(1),b=(0,h.j)(v,g);let k=(0,u.l)((0,h.j)(m,f),b);if(d){a.vA(null!=l,(()=>"When using zeroDebias: true, step is required."));const n=(0,o.YT)(l,"step","movingAverage");k=(0,i.y)(k,(0,h.j)(v,(0,c.n)(g,n)))}return(0,s.W)(f,k)}})},9258:(n,t,e)=>{e.d(t,{l:()=>i});var r=e(67897),o=e(15441),a=e(30565),s=e(28189);const i=(0,e(70929).op)({mul_:function(n,t){let e=(0,s.YT)(n,"a","mul"),i=(0,s.YT)(t,"b","mul");[e,i]=(0,a.h0)(e,i);const u={a:e,b:i};return r.T2.runKernel(o.xu7,u)}})},7843:(n,t,e)=>{e.d(t,{Y:()=>o});var r=e(28189);const o=(0,e(70929).op)({multiRNNCell_:function(n,t,e,o){const a=(0,r.YT)(t,"data","multiRNNCell"),s=(0,r.j1)(e,"c","multiRNNCell"),i=(0,r.j1)(o,"h","multiRNNCell");let u=a;const l=[];for(let t=0;t<n.length;t++){const e=n[t](u,s[t],i[t]);l.push(e[0]),l.push(e[1]),u=e[1]}const c=[],p=[];for(let n=0;n<l.length;n+=2)c.push(l[n]),p.push(l[n+1]);return[c,p]}})},71781:(n,t,e)=>{e.d(t,{O:()=>u});var r=e(67897),o=e(15441),a=e(28189),s=e(70929),i=e(62302);const u=(0,s.op)({multinomial_:function(n,t,e,s=!1){const u=(0,a.YT)(n,"logits","multinomial"),l=u.size,c=u.rank;if(l<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${l}.`);if(c>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${c}`);e=e||Math.random();const p={logits:1===c?(0,i.t)(u,[1,-1]):u},h={numSamples:t,seed:e,normalized:s},d=r.T2.runKernel(o.WT3,p,h);return 1===c?(0,i.t)(d,[d.size]):d}})},96522:(n,t,e)=>{e.d(t,{H:()=>s});var r=e(67897),o=e(15441),a=e(28189);const s=(0,e(70929).op)({neg_:function(n){const t={x:(0,a.YT)(n,"x","neg")};return r.T2.runKernel(o.l0G,t)}})}}]);